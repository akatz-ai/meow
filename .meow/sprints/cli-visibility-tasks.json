[
  {
    "name": "stream-a-meow-stop",
    "prompt": "# Stream A: Implement meow stop command\n\n## Overview\nImplement the complete `meow stop` feature chain: PID tracking in workflow type, storing PID on run, and the stop command itself.\n\n## Beads to implement (in order)\n1. **meow-23lz**: Add OrchestratorPID field to Workflow type\n2. **meow-2q9d**: Store PID on orchestrator start (run.go and resume.go)\n3. **meow-75om**: Implement meow stop command\n\nRun `bd show meow-23lz meow-2q9d meow-75om` for full implementation specs.\n\n## Files you'll touch\n- `internal/types/workflow.go` - Add OrchestratorPID field\n- `cmd/meow/cmd/run.go` - Store PID before orch.Run()\n- `cmd/meow/cmd/resume.go` - Store PID before orch.Run()\n- `cmd/meow/cmd/stop.go` - NEW FILE: the stop command\n\n## Key implementation notes\n1. OrchestratorPID field must be `yaml:\"orchestrator_pid,omitempty\"` for backwards compat\n2. PID validation is CRITICAL - check `/proc/<PID>/cmdline` contains \"meow\" before sending SIGTERM\n3. Handle edge cases: process not found (ESRCH), permission denied (EPERM), PID reuse\n4. Clear PID on clean exit (defer in run.go/resume.go)\n\n## Testing\n- Add unit test for workflow marshal/unmarshal with PID field\n- Add unit test for validateMeowProcess function\n- Run `go test -short ./...` before committing\n\n## DO NOT\n- Touch yamlstore.go (Stream B owns that)\n- Touch status.go (Stream C owns that)\n- Work on ls command (Stream B)\n\nClose beads as you complete each: `bd close meow-23lz`, etc."
  },
  {
    "name": "stream-b-meow-ls",
    "prompt": "# Stream B: Implement meow ls command\n\n## Overview\nImplement the complete `meow ls` feature: lock file detection and the ls command.\n\n## Beads to implement (in order)\n1. **meow-kdxl**: Add running detection via lock file check in yamlstore.go\n2. **meow-mubg**: Implement meow ls command\n\nRun `bd show meow-kdxl meow-mubg` for full implementation specs.\n\n## Files you'll touch\n- `internal/orchestrator/yamlstore.go` - Add IsLocked() method\n- `cmd/meow/cmd/ls.go` - NEW FILE: the ls command\n\n## Key implementation notes\n1. IsLocked() uses syscall.Flock with LOCK_NB to test if lock is held\n2. If LOCK_EX|LOCK_NB fails with EWOULDBLOCK, someone has the lock = running\n3. If we get the lock, release it immediately and return false\n4. ls command uses existing store.List() - no new discovery needed\n5. Sort workflows by StartedAt descending (most recent first)\n6. Mark stale workflows: status=running but IsLocked()=false\n\n## Output format\n```\nID                        STATUS           STARTED              TEMPLATE\nwf-1736634000000000000   running          2026-01-11 15:00:00  workflow.meow.toml\nwf-1736633500000000000   running (stale)  2026-01-11 14:45:00  build.meow.toml\n```\n\n## Flags to implement\n- `--running` - Show only running workflows\n- `--json` - Output as JSON\n- `--all` - Include all workflows (not just recent)\n\n## Testing\n- Add unit test for IsLocked() method\n- Add unit test for table formatting\n- Run `go test -short ./...` before committing\n\n## DO NOT\n- Touch workflow.go types (Stream A owns that)\n- Touch status.go (Stream C owns that)\n- Work on stop command (Stream A)\n\nClose beads as you complete: `bd close meow-kdxl`, then `bd close meow-mubg`."
  },
  {
    "name": "stream-c-meow-status",
    "prompt": "# Stream C: Implement meow status command\n\n## Overview\nImplement the `meow status` command with single-workflow detailed view.\n\n## Beads to implement\n1. **meow-2ba4**: Create status command scaffold with flags\n2. **meow-v3hv**: Implement detailed single-workflow view\n\nRun `bd show meow-2ba4 meow-v3hv` for full implementation specs.\n\n## Files you'll touch\n- `cmd/meow/cmd/status.go` - EXISTING FILE (stub): replace with real implementation\n\n## Key implementation notes\n1. `meow status <workflow-id>` shows detailed view of single workflow\n2. `meow status` with no args can print help or \"use meow ls to list workflows\"\n3. Display workflow metadata: ID, status, template, started/completed times\n4. Display step progress: X/Y steps done, list running steps\n5. Display agent info with tmux attach commands\n6. Display errors for failed workflows\n7. Support `--json` flag for scripted use\n\n## Detailed view format\n```\nWorkflow: wf-1736634000000000000\nTemplate: sprint.meow.toml\nStatus:   running\nStarted:  2026-01-11 15:00:00\n\nProgress: 8/15 steps complete\n\nRunning Steps:\n  - agents.0.track.work (agent: agent-0)\n  - agents.1.track.work (agent: agent-1)\n\nAgents:\n  agent-0: running\n    tmux attach -t meow-wf-1736634000000000000-agent-0\n  agent-1: running  \n    tmux attach -t meow-wf-1736634000000000000-agent-1\n```\n\n## Flags to implement\n- `--json` - Output as JSON\n- `--watch` or `-w` - Refresh every N seconds (optional, can defer)\n\n## Testing\n- Add unit test for output formatting\n- Run `go test -short ./...` before committing\n\n## DO NOT\n- Touch workflow.go types (Stream A owns that)\n- Touch yamlstore.go (Stream B owns that)  \n- Work on ls or stop commands (Streams A/B)\n\nClose beads as you complete: `bd close meow-2ba4`, then `bd close meow-v3hv`."
  }
]

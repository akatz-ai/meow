# Claude Code CLI adapter for MEOW
# This is the built-in default adapter

[adapter]
name = "claude"
description = "Claude Code CLI agent"

[spawn]
# Command to start Claude Code in headless mode
command = "claude --dangerously-skip-permissions"
# Command to resume an existing session (uses {{session_id}} placeholder)
resume_command = "claude --dangerously-skip-permissions --resume {{session_id}}"
# Time to wait for Claude to fully start up before sending prompts
startup_delay = "3s"

[environment]
# Prevent Claude from detecting it's in an outer tmux session
# This avoids potential interactions with the parent tmux server
TMUX = ""

[prompt_injection]
# Keys to send before the prompt to ensure clean state
# Escape exits copy mode and any other modal state
pre_keys = ["Escape"]
# Small delay after pre_keys for the state change to take effect
pre_delay = "100ms"
# How to send the prompt text:
# - "literal": tmux send-keys -l (handles special chars and newlines)
# - "keys": tmux send-keys without -l (interprets key names)
method = "literal"
# Keys to send after the prompt to submit it
post_keys = ["Enter"]
# Time to wait between sending prompt and sending post_keys
# This ensures the prompt is fully received before Enter is pressed
post_delay = "500ms"

[graceful_stop]
# Keys to send to initiate graceful shutdown
keys = ["C-c"]
# Time to wait for graceful shutdown before force killing
wait = "2s"

[events]
# Path to event translator script (relative to adapter directory)
translator = "./event-translator.sh"

# Agent-specific hook configuration for .claude/settings.json
# Uses {{adapter_dir}} placeholder for the adapter directory path
[events.agent_config]
Stop = "{{adapter_dir}}/event-translator.sh Stop"
PreToolUse = "{{adapter_dir}}/event-translator.sh PreToolUse $TOOL_NAME"
PostToolUse = "{{adapter_dir}}/event-translator.sh PostToolUse $TOOL_NAME"

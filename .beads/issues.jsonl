{"id":"meow-00g","title":"Define standard label conventions for tiers","description":"Define label conventions for beads. Per SPEC-ADDENDUM, the Tier field is now primary for tier detection.\n\n## Reduced Scope\n\nLabels are now OPTIONAL metadata, not the primary tier mechanism. The explicit `Tier` field handles tier filtering.\n\n## Standard Labels (Optional)\n\n| Label | Purpose |\n|-------|---------|\n| `meow:workflow:{id}` | Track which workflow instance created this bead |\n| `meow:ephemeral` | Mark for cleanup after workflow completion |\n\n## What Changed\n\n- **Removed**: `meow:wisp` and `meow:orchestrator` labels as tier indicators\n- **Added**: Explicit `Tier` field on Bead struct (handled by meow-bba)\n- Labels are now for grouping/filtering, not tier determination\n\n## File Location\nModify: `internal/types/bead.go` (label constants if any)\n\n## Acceptance Criteria\n- [ ] Document label conventions in code comments\n- [ ] Remove any code that computes tier from labels\n- [ ] Workflow ID label helper function if needed","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T16:38:53.186807739-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:14:05.917253075-05:00","closed_at":"2026-01-07T18:14:05.917253075-05:00","close_reason":"Consolidated into meow-dax (tier-based bead filtering). Label conventions are part of the unified filtering implementation.","dependencies":[{"issue_id":"meow-00g","depends_on_id":"meow-bba","type":"blocks","created_at":"2026-01-07T16:39:46.693798695-05:00","created_by":"ubuntu"}]}
{"id":"meow-0tx","title":"Implement attach_wisp processing","description":"Handle explicit wisp attachment via attach_wisp field. See IMPLEMENTATION-PLAN section meow-modules-baker-attach.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T16:39:05.987317851-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:13:20.118627958-05:00","closed_at":"2026-01-07T18:13:20.118627958-05:00","close_reason":"YAGNI - attach_wisp processing not needed. Auto-detection via ephemeral=true workflow property plus hooks_to for HookBead linking handles all real use cases. Can resurrect if a real use case emerges.","dependencies":[{"issue_id":"meow-0tx","depends_on_id":"meow-cxt","type":"blocks","created_at":"2026-01-07T16:39:47.339612162-05:00","created_by":"ubuntu"}]}
{"id":"meow-0x5","title":"Templates: Module Format Examples","description":"Create example templates using module format. Phase 4.","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-07T16:38:26.126049796-05:00","created_by":"ubuntu","updated_at":"2026-01-07T16:38:26.126049796-05:00"}
{"id":"meow-1ir","title":"Implement format detection logic","description":"Detect whether file is legacy ([meta]) or module format ([workflow-name]). See IMPLEMENTATION-PLAN section meow-modules-parser-detect.","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T16:38:36.035558315-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:18:10.442885234-05:00","dependencies":[{"issue_id":"meow-1ir","depends_on_id":"meow-8x2","type":"blocks","created_at":"2026-01-07T16:39:46.322602835-05:00","created_by":"ubuntu"}]}
{"id":"meow-1l1","title":"Add BeadTypeCollaborative for interactive agent-user steps","description":"Add new `collaborative` bead type per SPEC-ADDENDUM-WISPS-AND-MODULES.md (lines 241-326).\n\n## The Collaborative Type\n\nThe `collaborative` type enables **human-in-the-loop interaction** within an otherwise autonomous workflow. Unlike `task` which auto-continues via the Ralph Wiggum loop, `collaborative` pauses for conversation.\n\n```go\nconst (\n    // Agent-executable\n    BeadTypeTask          BeadType = \"task\"          // Agent does work, auto-continues\n    BeadTypeCollaborative BeadType = \"collaborative\" // Agent + human conversation, pauses\n    BeadTypeGate          BeadType = \"gate\"          // Human approval point (no assignee)\n    \n    // Orchestrator-executable\n    BeadTypeStart     BeadType = \"start\"\n    BeadTypeStop      BeadType = \"stop\"\n    BeadTypeCondition BeadType = \"condition\"\n    BeadTypeCode      BeadType = \"code\"\n    BeadTypeExpand    BeadType = \"expand\"\n)\n```\n\n## Type Behavior Summary\n\n| Type | Assignee | Auto-continue | Who closes | Use case |\n|------|----------|---------------|------------|----------|\n| `task` | Required | Yes (Ralph Wiggum) | Agent | Normal autonomous work |\n| `collaborative` | Required | No (pauses) | Agent | Design review, clarification |\n| `gate` | None | No | Human | Approval checkpoints |\n\n## How Collaborative Works\n\n1. Agent executes step (presents info, asks questions)\n2. Agent's stop hook fires, BUT...\n3. `meow prime --format prompt` returns **empty** for in-progress collaborative steps\n4. No prompt injection → Claude waits for user input\n5. User and agent converse freely\n6. Agent runs `meow close \u003cstep-id\u003e` when done\n7. Next stop hook fires, normal flow resumes\n\n## Validation Rules\n\n- **Must have assignee** - Unlike gate, collaborative needs an agent\n- **Tier detection** - Handled same as task (wisp if in ephemeral workflow)\n\n## File Location\nModify: `internal/types/bead.go`\n\n## Acceptance Criteria\n- [ ] BeadTypeCollaborative constant added\n- [ ] Valid() updated to include collaborative\n- [ ] Collaborative validation: must have assignee (like task)\n- [ ] Unit tests for collaborative type\n- [ ] Documentation updated","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T17:59:06.403106737-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:14:51.294256315-05:00","closed_at":"2026-01-07T18:14:51.294256315-05:00","close_reason":"Consolidated into meow-bba. The collaborative type is now part of the unified Bead struct changes task.","dependencies":[{"issue_id":"meow-1l1","depends_on_id":"meow-bba","type":"blocks","created_at":"2026-01-07T17:59:17.523010622-05:00","created_by":"ubuntu"}]}
{"id":"meow-40s","title":"Implement load context tracking","description":"LoadContext struct for current file, module, cycle detection. See IMPLEMENTATION-PLAN section meow-modules-loader-context.","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T16:39:05.320905842-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:17:49.444231959-05:00","dependencies":[{"issue_id":"meow-40s","depends_on_id":"meow-7x5","type":"blocks","created_at":"2026-01-07T16:40:07.258337447-05:00","created_by":"ubuntu"}]}
{"id":"meow-461","title":"Implement helpful error messages for loading","description":"Typed errors with context and hints for reference failures. See IMPLEMENTATION-PLAN section meow-modules-loader-errors.","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T16:39:05.605093738-05:00","created_by":"ubuntu","updated_at":"2026-01-07T16:39:05.605093738-05:00","dependencies":[{"issue_id":"meow-461","depends_on_id":"meow-dvr","type":"blocks","created_at":"2026-01-07T16:39:47.066078331-05:00","created_by":"ubuntu"}]}
{"id":"meow-58l","title":"Implement module validation","description":"Validate local references, detect cycles, check internal visibility. See IMPLEMENTATION-PLAN section meow-modules-parser-validate.","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T16:38:36.217177591-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:18:10.34511579-05:00","dependencies":[{"issue_id":"meow-58l","depends_on_id":"meow-ao5","type":"blocks","created_at":"2026-01-07T16:39:46.506194238-05:00","created_by":"ubuntu"}]}
{"id":"meow-5d8","title":"Create implement-tdd module","description":"TDD workflow as part of work-loop module. See IMPLEMENTATION-PLAN.","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T16:39:25.459141219-05:00","created_by":"ubuntu","updated_at":"2026-01-07T16:39:25.459141219-05:00","dependencies":[{"issue_id":"meow-5d8","depends_on_id":"meow-5u6","type":"blocks","created_at":"2026-01-07T16:39:48.083913963-05:00","created_by":"ubuntu"}]}
{"id":"meow-5u6","title":"Create work-loop module template","description":"Main loop: select work, implement, repeat. Module format example. See IMPLEMENTATION-PLAN section meow-modules-templates-workloop.","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T16:39:25.337170169-05:00","created_by":"ubuntu","updated_at":"2026-01-07T16:39:25.337170169-05:00","dependencies":[{"issue_id":"meow-5u6","depends_on_id":"meow-74h","type":"blocks","created_at":"2026-01-07T16:40:07.961661718-05:00","created_by":"ubuntu"}]}
{"id":"meow-5yi","title":"Orchestrator: Tier-Aware Processing","description":"Update orchestrator for three-tier bead model. Phase 3.","status":"open","priority":0,"issue_type":"epic","created_at":"2026-01-07T16:38:25.937979017-05:00","created_by":"ubuntu","updated_at":"2026-01-07T16:38:25.937979017-05:00"}
{"id":"meow-74b","title":"Create MEOW beads fork strategy and implementation","description":"Per SPEC-ADDENDUM-WISPS-AND-MODULES.md (lines 63-109), MEOW Stack requires a fork of the beads CLI/library.\n\n## Rationale\n\nThe upstream `beads` project is general-purpose issue tracking. MEOW requires:\n\n1. **New bead types** - `start`, `stop`, `condition`, `code`, `expand`, `gate` as first-class `IssueType` values\n2. **Tier field** - Explicit `Tier` enum on the Issue struct (not computed from labels)\n3. **Workflow metadata** - `HookBead`, `SourceWorkflow`, `WorkflowID` fields\n4. **Custom statuses** - Potentially workflow-specific status values\n5. **Output storage** - `Outputs map[string]any` for bead-to-bead data flow\n6. **Type-specific specs** - `ConditionSpec`, `StartSpec`, etc. on the Issue struct\n\n## Fork Strategy\n\n```\ngithub.com/anthropics/beads           # Upstream (general issue tracking)\ngithub.com/meow-stack/meow-beads      # Fork (workflow orchestration)\n```\n\n## Implementation Options\n\n**Option A: Internal Types (Current Approach)**\n- Define MEOW-specific types in `internal/types/bead.go`\n- Adapter layer to convert to/from upstream beads format\n- Pros: No fork maintenance, gradual adoption\n- Cons: Type conversion overhead, schema drift\n\n**Option B: True Fork**\n- Fork upstream beads to meow-beads repo\n- Extend Issue struct directly\n- Pros: Clean integration, single source of truth\n- Cons: Fork maintenance burden\n\n**Recommendation**: Start with Option A (internal types), evaluate fork if needed.\n\n## Current State\n\nThe existing `internal/types/bead.go` already defines MEOW-specific Bead struct. This task is to:\n1. Document the relationship to upstream beads\n2. Ensure type conversion works correctly\n3. Plan for potential future fork if internal types become unwieldy\n\n## Acceptance Criteria\n- [ ] Document fork strategy in ARCHITECTURE.md\n- [ ] Verify internal types cover all MEOW requirements\n- [ ] Add type conversion helpers if using upstream beads storage\n- [ ] Update meow-e8.1 (beads integration) with this context","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T17:53:04.241715524-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:13:01.044397277-05:00","closed_at":"2026-01-07T18:13:01.044397277-05:00","close_reason":"No fork needed - internal types in internal/types/bead.go already implement MEOW-specific fields. The beads CLI uses JSONL format which we can read/write directly. Document this decision in ARCHITECTURE.md as part of normal docs work."}
{"id":"meow-74h","title":"Implement meow close with output validation","description":"Validate required outputs before closing wisp steps per SPEC-ADDENDUM.\n\n## Usage\n\n```bash\n# Close with required outputs\nmeow close select-work \\\n    --output work_bead=gt-123 \\\n    --output rationale=\"Highest priority, unblocks 3 others\"\n\n# Or with JSON\nmeow close select-work --output-json '{\n    \"work_bead\": \"gt-123\",\n    \"rationale\": \"Highest priority, unblocks 3 others\"\n}'\n```\n\n## Validation\n\n```go\nfunc CloseWispStep(ctx context.Context, store Store, stepID string, outputs map[string]string) error {\n    step, _ := store.Get(ctx, stepID)\n    \n    // Validate outputs against TaskOutputSpec\n    if err := validateOutputs(step, outputs); err \\!= nil {\n        return err  // Reject close if outputs invalid\n    }\n    \n    step.Outputs = outputs\n    step.Status = StatusClosed  // Direct to closed, no 'hooked' intermediate\n    step.ClosedAt = time.Now()\n    \n    return store.Update(ctx, step)\n}\n```\n\n## Output Types (from types.TaskOutputType)\n\n| Type | Validation |\n|------|------------|\n| string | Non-empty |\n| bead_id | Bead exists in store |\n| number | Parseable as float |\n| boolean | \"true\" or \"false\" |\n| file_path | File exists |\n\n## Key Changes from Implementation Plan\n\n- **No hooked status** - Status goes directly from in_progress to closed\n- **bead_id validation** - Validates bead exists, not just string format\n\n## File Location\nModify: `cmd/meow/cmd/close.go`\n\n## Acceptance Criteria\n- [ ] Validates required outputs before close\n- [ ] bead_id type validates bead exists\n- [ ] Stores outputs on bead\n- [ ] Helpful error messages for missing/invalid outputs","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T16:39:25.095279763-05:00","created_by":"ubuntu","updated_at":"2026-01-07T17:54:41.907119973-05:00","dependencies":[{"issue_id":"meow-74h","depends_on_id":"meow-97m","type":"blocks","created_at":"2026-01-07T16:39:47.896983716-05:00","created_by":"ubuntu"}]}
{"id":"meow-7x5","title":"Maintain legacy format compatibility","description":"ParseAny() that handles both formats, Template.ToModule() conversion. See IMPLEMENTATION-PLAN section meow-modules-parser-legacy.","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T16:38:36.313359455-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:18:10.255814398-05:00","dependencies":[{"issue_id":"meow-7x5","depends_on_id":"meow-58l","type":"blocks","created_at":"2026-01-07T16:39:46.600180287-05:00","created_by":"ubuntu"}]}
{"id":"meow-8x2","title":"Define module-level parser types","description":"Define module-level parser types per SPEC-ADDENDUM-WISPS-AND-MODULES.md.\n\n## Types to Define\n\n```go\n// FileFormat indicates the template file format\ntype FileFormat int\n\nconst (\n    FormatLegacy FileFormat = iota  // [meta] + [[steps]]\n    FormatModule                     // [workflow-name] sections\n)\n\n// Module represents a parsed module file\ntype Module struct {\n    Path      string               // File path for error messages\n    Workflows map[string]*Workflow // Named workflows\n}\n\n// Workflow represents a single workflow within a module\ntype Workflow struct {\n    Name        string           `toml:\"name\"`\n    Description string           `toml:\"description,omitempty\"`\n    Ephemeral   bool             `toml:\"ephemeral,omitempty\"`\n    Internal    bool             `toml:\"internal,omitempty\"`\n    HooksTo     string           `toml:\"hooks_to,omitempty\"`    // Links wisps to this variable's bead ID\n    Variables   map[string]*Var  `toml:\"variables,omitempty\"`\n    Steps       []*Step          `toml:\"steps\"`\n}\n\n// Step type field accepts:\n// - task | collaborative | gate | condition | code | start | stop | expand\n```\n\n## Key Addition: HooksTo Property\n\nThe `HooksTo` field declares which variable contains the work bead ID that all wisps from this workflow should link to:\n\n```toml\n[implement]\nephemeral = true\nhooks_to = \"work_bead\"   # All wisps link to {{work_bead}}\n```\n\nThis replaces magic variable name detection with explicit declaration.\n\n## Step Type Validation\n\nValid step types per SPEC-ADDENDUM:\n- `task` - Agent work, auto-continues\n- `collaborative` - Agent + human conversation, pauses\n- `gate` - Human approval (no assignee)\n- `condition` - Branch/loop/wait\n- `code` - Shell execution\n- `start` - Spawn agent\n- `stop` - Kill agent\n- `expand` - Template expansion\n\n## File Location\nCreate: `internal/template/module.go`\n\n## Acceptance Criteria\n- [ ] FileFormat enum defined\n- [ ] Module struct with Workflows map\n- [ ] Workflow struct with HooksTo field\n- [ ] Step type validation includes all 8 types\n- [ ] Helper methods: GetWorkflow(), DefaultWorkflow(), IsInternal()\n- [ ] Unit tests for helper methods","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T16:38:35.94360773-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:46:43.81964419-05:00","closed_at":"2026-01-07T18:46:43.81964419-05:00","close_reason":"Implemented minimal viable slice: module parser, tier tracking, and meow prime command"}
{"id":"meow-97m","title":"Implement wisp-aware meow prime","description":"Show workflow progression, work bead, current step per SPEC-ADDENDUM. **Crucially, returns empty output for in-progress collaborative steps** to disable auto-continuation.\n\n## Output Format\n\n```\n═══════════════════════════════════════════════════════════════\nYour workflow: implement-tdd (step 2/4)\nWork bead: gt-123 \"Implement auth endpoint\"\n═══════════════════════════════════════════════════════════════\n\n  ✓ load-context\n  → write-tests [in_progress] ← YOU ARE HERE\n  ○ implement\n  ○ commit\n\n───────────────────────────────────────────────────────────────\nInstructions:\n  Write failing tests that define the expected behavior.\n  Tests MUST fail at this point.\n\nRequired outputs: (none)\n───────────────────────────────────────────────────────────────\n```\n\n## Implementation with Collaborative Support\n\n```go\nfunc Prime(ctx context.Context, store Store, agentID string, format string) (*PrimeOutput, error) {\n    // Check for in-progress collaborative step first\n    inProgress, _ := store.List(ctx, BeadFilter{\n        Tier:     TierWisp,\n        Assignee: agentID,\n        Status:   StatusInProgress,\n    })\n    \n    for _, step := range inProgress {\n        if step.Type == BeadTypeCollaborative {\n            // Collaborative step in progress - don't auto-continue!\n            if format == \"prompt\" {\n                return nil, nil  // Empty output = no injection\n            }\n            // For non-prompt format, show status with conversation mode flag\n            return \u0026PrimeOutput{\n                Workflow:         getWorkflowInfo(step),\n                WorkBead:         getHookBead(step),\n                ConversationMode: true,  // Signal to UI\n            }, nil\n        }\n    }\n    \n    // Normal flow: filter wisps for this agent (Tier field, not labels)\n    wispSteps, _ := store.List(ctx, BeadFilter{\n        Tier:     TierWisp,\n        Assignee: agentID,\n        Statuses: []BeadStatus{StatusOpen, StatusInProgress},\n    })\n    \n    // Get linked work bead via HookBead field\n    var workBead *types.Bead\n    if current.HookBead != \"\" {\n        workBead, _ = store.Get(ctx, current.HookBead)\n    }\n    // ...\n}\n```\n\n## Stop Hook Integration\n\nThe stop hook relies on empty output for collaborative steps:\n\n```bash\n#!/bin/bash\n# .claude/hooks/stop-hook.sh\n\noutput=$(meow prime --format prompt 2\u003e/dev/null)\n\nif [ -z \"$output\" ]; then\n    # Empty = collaborative mode OR no more work\n    exit 0\nfi\n\n# Normal task - inject the next prompt\necho \"$output\"\n```\n\n## Key Changes from Original Plan\n\n- **Collaborative check first** - Before finding next step, check for in-progress collaborative\n- **Empty output for collaborative** - `--format prompt` returns nothing\n- **ConversationMode flag** - Non-prompt formats can indicate conversation mode\n- **No hooked status** - Only open, in_progress, closed\n- **Filter on Tier field** - Not labels\n\n## File Location\nModify: `cmd/meow/cmd/prime.go`\n\n## Acceptance Criteria\n- [ ] Shows workflow progression (step N/M)\n- [ ] Shows linked work bead title\n- [ ] Shows current step instructions\n- [ ] Shows required outputs if any\n- [ ] Only shows agent's wisps (tier + assignee filter)\n- [ ] Returns empty for in-progress collaborative steps (--format prompt)\n- [ ] ConversationMode flag for non-prompt formats","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T16:39:24.846649317-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:00:05.203234884-05:00","dependencies":[{"issue_id":"meow-97m","depends_on_id":"meow-ym3","type":"blocks","created_at":"2026-01-07T16:40:07.83918555-05:00","created_by":"ubuntu"},{"issue_id":"meow-97m","depends_on_id":"meow-cac","type":"blocks","created_at":"2026-01-07T18:15:48.910620418-05:00","created_by":"ubuntu"}]}
{"id":"meow-a85","title":"Add filter types for tier-based queries","description":"Add filter types for tier-based queries. Per SPEC-ADDENDUM, filter on explicit Tier field, not labels.\n\n## Filter Structure\n\n```go\ntype BeadFilter struct {\n    // Existing filters...\n    Status     *BeadStatus\n    Assignee   *string\n    \n    // NEW: Tier-based filtering (explicit field, not labels)\n    Tier       *BeadTier      // Filter by tier: work, wisp, orchestrator\n    \n    // Workflow context\n    WorkflowID *string        // Filter by workflow instance\n    HookBead   *string        // Filter wisps for specific work bead\n    \n    // Exclusions\n    ExcludeTiers []BeadTier   // Exclude specific tiers\n}\n```\n\n## Key Design Decisions\n\n1. **Filter on Tier field** - O(1) comparison, not label scanning\n2. **ExcludeTiers** - For `bd ready` to exclude wisps/orchestrator beads\n3. **HookBead filter** - Find all wisps implementing a work bead\n\n## File Location\nModify: `internal/types/bead.go` or new `internal/types/filter.go`\n\n## Acceptance Criteria\n- [ ] BeadFilter struct with Tier field\n- [ ] ExcludeTiers slice for exclusion filtering\n- [ ] WorkflowID and HookBead filters\n- [ ] Unit tests for filter matching","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T16:38:53.281343266-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:14:08.211132779-05:00","closed_at":"2026-01-07T18:14:08.211132779-05:00","close_reason":"Consolidated into meow-dax (tier-based bead filtering). Filter types are part of the unified filtering implementation.","dependencies":[{"issue_id":"meow-a85","depends_on_id":"meow-00g","type":"blocks","created_at":"2026-01-07T16:39:46.78803388-05:00","created_by":"ubuntu"}]}
{"id":"meow-ao5","title":"Implement module parsing","description":"Two-phase TOML parsing for dynamic [workflow-name] sections. See IMPLEMENTATION-PLAN section meow-modules-parser-parse.","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T16:38:36.123911948-05:00","created_by":"ubuntu","updated_at":"2026-01-07T16:38:36.123911948-05:00","dependencies":[{"issue_id":"meow-ao5","depends_on_id":"meow-8x2","type":"blocks","created_at":"2026-01-07T16:39:46.412519728-05:00","created_by":"ubuntu"}]}
{"id":"meow-bba","title":"Add wisp tracking fields to Bead struct","description":"Add workflow metadata fields AND new bead types to MEOW's internal Bead struct.\n\n**Context**: Per the overlay approach (no beads fork), MEOW defines its own `Bead` type in `internal/types/bead.go`. This type serializes to JSON and is written to the shared `.beads/issues.jsonl` file. Upstream `bd` CLI will preserve but ignore MEOW-specific fields.\n\n**CONSOLIDATED**: Now includes meow-1l1 (collaborative type) and meow-x9z (gate type).\n\n## Fields to Add\n\n```go\ntype Bead struct {\n    // ... existing fields ...\n    \n    // MEOW-specific: Explicit tier (ignored by upstream bd)\n    Tier          BeadTier       `json:\"tier,omitempty\"`           // work | wisp | orchestrator\n    \n    // MEOW-specific: Workflow tracking (ignored by upstream bd)\n    HookBead       string        `json:\"hook_bead,omitempty\"`      // Work bead this wisp implements\n    SourceWorkflow string        `json:\"source_workflow,omitempty\"` // Workflow that created this\n    WorkflowID     string        `json:\"workflow_id,omitempty\"`    // Unique workflow instance ID\n    \n    // Optional heartbeat\n    LastSeen       time.Time     `json:\"last_seen,omitempty\"`      // Agent heartbeat timestamp\n}\n\ntype BeadTier string\n\nconst (\n    TierWork        BeadTier = \"work\"        // Permanent deliverables  \n    TierWisp        BeadTier = \"wisp\"        // Agent workflow steps (ephemeral)\n    TierOrchestrator BeadTier = \"orchestrator\" // Infrastructure machinery (ephemeral)\n)\n```\n\n## Bead Types (8 total - was 6)\n\n```go\nconst (\n    // Agent-executable\n    BeadTypeTask          BeadType = \"task\"          // Agent does work, auto-continues\n    BeadTypeCollaborative BeadType = \"collaborative\" // Agent + human conversation, pauses\n    BeadTypeGate          BeadType = \"gate\"          // Human approval point (no assignee)\n    \n    // Orchestrator-executable  \n    BeadTypeStart     BeadType = \"start\"\n    BeadTypeStop      BeadType = \"stop\"\n    BeadTypeCondition BeadType = \"condition\"\n    BeadTypeCode      BeadType = \"code\"\n    BeadTypeExpand    BeadType = \"expand\"\n)\n```\n\n## Type-Specific Validation Rules\n\n**collaborative**:\n- MUST have assignee (agent runs the conversation)\n- Auto-continue: NO (meow prime returns empty for in-progress)\n- Tier: wisp (if in ephemeral workflow) or work\n\n**gate**:\n- MUST NOT have assignee (human-facing, not agent-facing)\n- Auto-continue: NO\n- Tier: always orchestrator\n\n## JSON Interoperability\n\nWhen serialized to `issues.jsonl`:\n```json\n{\n  \"id\": \"meow-abc.load-context\",\n  \"title\": \"Load context for bd-task-123\",\n  \"status\": \"open\",\n  \"tier\": \"wisp\",\n  \"hook_bead\": \"bd-task-123\",\n  \"source_workflow\": \"implement-tdd\",\n  \"workflow_id\": \"meow-abc\"\n}\n```\n\nUpstream `bd` will:\n- ✅ Read and display `id`, `title`, `status`\n- ✅ Preserve `tier`, `hook_bead`, etc. when modifying\n- ❌ Not understand MEOW-specific fields (but won't break)\n\n## File Location\nModify: `internal/types/bead.go`\n\n## Acceptance Criteria\n- [ ] BeadTier enum defined with work/wisp/orchestrator\n- [ ] Tier field added to Bead struct with `omitempty`\n- [ ] HookBead, SourceWorkflow, WorkflowID fields added with `omitempty`\n- [ ] BeadTypeCollaborative added with validation (must have assignee)\n- [ ] BeadTypeGate added with validation (must NOT have assignee)\n- [ ] Valid() updated for all 8 types\n- [ ] JSON round-trip test (serialize → deserialize preserves all fields)\n- [ ] Unit tests for tier and type validation","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T16:38:52.992979411-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:46:43.827822479-05:00","closed_at":"2026-01-07T18:46:43.827822479-05:00","close_reason":"Implemented minimal viable slice: module parser, tier tracking, and meow prime command"}
{"id":"meow-c32","title":"Add tier-based filtering to bead queries","description":"BeadStore methods for filtered queries by Tier field per SPEC-ADDENDUM.\n\n## Key Change: Tier Field, Not Labels\n\nFilter on explicit `Tier` field for O(1) comparison:\n\n```go\n// Filter by tier field directly\nfilter := BeadFilter{\n    Tier: TierWisp,\n    Assignee: agentID,\n}\n\n// NOT label scanning\n// BAD: Labels: []string{\"meow:wisp\"}\n```\n\n## Methods to Update\n\n```go\ntype BeadStore interface {\n    // Existing...\n    \n    // Add tier-aware filtering\n    ListByTier(ctx context.Context, tier BeadTier) ([]*types.Bead, error)\n    GetReadyByTier(ctx context.Context, tier BeadTier) ([]*types.Bead, error)\n    \n    // Generic filter with tier support\n    List(ctx context.Context, filter BeadFilter) ([]*types.Bead, error)\n}\n\ntype BeadFilter struct {\n    Tier         *BeadTier\n    ExcludeTiers []BeadTier\n    Status       *BeadStatus\n    Assignee     *string\n    WorkflowID   *string\n    HookBead     *string\n}\n```\n\n## Performance\n\n- **Before**: O(n * labels) to scan labels for tier\n- **After**: O(n) with direct field comparison\n\n## File Location\nModify: `internal/orchestrator/beadstore.go`\n\n## Acceptance Criteria\n- [ ] BeadFilter supports Tier field\n- [ ] ExcludeTiers for negative filtering\n- [ ] Direct field comparison (no label scanning)\n- [ ] Unit tests for tier filtering","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T16:39:24.607344386-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:14:11.143681356-05:00","closed_at":"2026-01-07T18:14:11.143681356-05:00","close_reason":"Consolidated into meow-dax (tier-based bead filtering). Query implementation is part of the unified filtering implementation.","dependencies":[{"issue_id":"meow-c32","depends_on_id":"meow-d1h","type":"blocks","created_at":"2026-01-07T16:39:47.619473429-05:00","created_by":"ubuntu"}]}
{"id":"meow-cac","title":"CRITICAL: Minimal vertical slice - validate architecture end-to-end","description":"## Purpose\n\nValidate the three-tier architecture works end-to-end BEFORE implementing all edge cases. This is a focused integration test, not production code.\n\n## The Slice\n\nImplement the **smallest possible working flow**:\n\n```\nSimple module → Parse → Bake with tiers → meow prime shows wisps\n```\n\n### Input: Minimal Test Module\n\n```toml\n# test-slice.meow.toml\n\n[main]\nname = \"test-slice\"\ndescription = \"Minimal vertical slice test\"\nephemeral = true\nhooks_to = \"work_bead\"\n\n[main.variables]\nwork_bead = { required = true, type = \"bead_id\" }\nagent = { required = true, type = \"string\" }\n\n[[main.steps]]\nid = \"step-1\"\ntype = \"task\"\ntitle = \"First wisp step\"\nassignee = \"{{agent}}\"\ninstructions = \"Do the first thing\"\n\n[[main.steps]]\nid = \"step-2\" \ntype = \"task\"\ntitle = \"Second wisp step\"\nassignee = \"{{agent}}\"\nneeds = [\"step-1\"]\ninstructions = \"Do the second thing\"\n```\n\n### Expected Output from `meow prime`\n\n```\n═══════════════════════════════════════════════════════════════\nYour workflow: test-slice (step 1/2)\nWork bead: gt-test-123 \"Test work bead\"\n═══════════════════════════════════════════════════════════════\n\n  → step-1 [in_progress] ← YOU ARE HERE\n  ○ step-2\n\n───────────────────────────────────────────────────────────────\nInstructions:\n  Do the first thing\n───────────────────────────────────────────────────────────────\n```\n\n## Implementation Steps\n\n1. **Module parsing** (use existing parser, extend minimally)\n   - Detect module format (has workflow sections, no [meta])\n   - Parse [main] workflow with steps\n   - Parse variables and hooks_to\n\n2. **Baking with tiers** (extend Baker)\n   - Set Tier = TierWisp for tasks in ephemeral workflow\n   - Set HookBead from hooks_to variable\n   - Set SourceWorkflow and WorkflowID\n\n3. **meow prime output** (new implementation)\n   - Filter beads by Tier = TierWisp AND Assignee = current agent\n   - Format as workflow progression view\n   - Show linked work bead\n\n4. **Integration test**\n   - End-to-end test that:\n     a. Creates a work bead\n     b. Parses the test module\n     c. Bakes with work_bead variable\n     d. Verifies beads have correct tiers\n     e. Calls prime and verifies output format\n\n## What This Validates\n\n- [ ] Module format detection works\n- [ ] Workflow parsing captures ephemeral and hooks_to\n- [ ] Baker correctly sets Tier field based on ephemeral\n- [ ] Baker correctly sets HookBead from hooks_to\n- [ ] Prime filters by tier and formats correctly\n- [ ] Three-tier separation actually works\n\n## What This Does NOT Include\n\n- Legacy format support (separate task)\n- Local references (.implement syntax)\n- External references (file#workflow syntax)\n- Output validation\n- collaborative/gate types\n- Wisp burning/cleanup\n- Full CLI argument handling\n\n## Files to Create/Modify\n\n- `internal/template/module.go` - Minimal module parsing\n- `internal/template/baker.go` - Tier assignment\n- `cmd/meow/cmd/prime.go` - Wisp-aware output\n- `internal/orchestrator/beadstore.go` - Tier filtering\n- `internal/integration_test.go` - End-to-end test\n\n## Success Criteria\n\nThe integration test passes. That's it. This validates the architecture.\n\n## Why This Matters\n\nIf this slice doesn't work, we need to revisit the architecture before building out 40+ other tasks. Fail fast.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T18:15:23.71154853-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:46:43.829458144-05:00","closed_at":"2026-01-07T18:46:43.829458144-05:00","close_reason":"Implemented minimal viable slice: module parser, tier tracking, and meow prime command","dependencies":[{"issue_id":"meow-cac","depends_on_id":"meow-bba","type":"blocks","created_at":"2026-01-07T18:15:31.076044494-05:00","created_by":"ubuntu"},{"issue_id":"meow-cac","depends_on_id":"meow-8x2","type":"blocks","created_at":"2026-01-07T18:15:31.166052471-05:00","created_by":"ubuntu"}]}
{"id":"meow-cxt","title":"Apply tier labels and metadata","description":"Apply tier and metadata when baking beads. Set explicit Tier field as primary mechanism.\n\n## Tier Assignment Logic\n\n```go\nfunc (b *Baker) determineTier(step *Step, workflow *Workflow) BeadTier {\n    // Non-agent-executable types are always orchestrator\n    if step.Type != \"task\" \u0026\u0026 step.Type != \"collaborative\" \u0026\u0026 step.Type != \"gate\" {\n        return TierOrchestrator\n    }\n    \n    // Gates are orchestrator (human-facing, no agent assignee)\n    if step.Type == \"gate\" {\n        return TierOrchestrator\n    }\n    \n    // Tasks and collaborative in ephemeral workflow → wisp\n    if workflow.Ephemeral {\n        return TierWisp\n    }\n    \n    // Default: work bead\n    return TierWork\n}\n```\n\n## Metadata to Set\n\n1. **Tier** - From determineTier()\n2. **SourceWorkflow** - workflow.Name\n3. **WorkflowID** - Unique instance ID\n4. **HookBead** - From workflow.HooksTo variable (see meow-p84)\n\n## Key Changes from Original Plan\n\n- `collaborative` type handled same as `task` for tier purposes\n- Set `bead.Tier` field directly (not via labels)\n- Labels are optional (`meow:workflow:{id}` for grouping)\n- No `meow:wisp` or `meow:orchestrator` labels needed\n\n## File Location\nModify: `internal/template/baker.go`\n\n## Acceptance Criteria\n- [ ] determineTier() handles task, collaborative, gate correctly\n- [ ] SourceWorkflow set from workflow name\n- [ ] WorkflowID set from baker context\n- [ ] Unit tests for tier assignment including collaborative","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T16:39:05.891186647-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:17:22.229859276-05:00","closed_at":"2026-01-07T18:17:22.229859276-05:00","close_reason":"Covered by meow-cac (vertical slice). determineTier(), SourceWorkflow, WorkflowID are all part of the minimal baking implementation. Production hardening can happen incrementally after slice validates approach.","dependencies":[{"issue_id":"meow-cxt","depends_on_id":"meow-fxw","type":"blocks","created_at":"2026-01-07T16:39:47.245430398-05:00","created_by":"ubuntu"},{"issue_id":"meow-cxt","depends_on_id":"meow-x9z","type":"blocks","created_at":"2026-01-07T17:53:25.253459399-05:00","created_by":"ubuntu"},{"issue_id":"meow-cxt","depends_on_id":"meow-1l1","type":"blocks","created_at":"2026-01-07T17:59:22.839142317-05:00","created_by":"ubuntu"},{"issue_id":"meow-cxt","depends_on_id":"meow-cac","type":"blocks","created_at":"2026-01-07T18:16:51.776633061-05:00","created_by":"ubuntu"},{"issue_id":"meow-cxt","depends_on_id":"meow-bba","type":"blocks","created_at":"2026-01-07T18:16:51.874234617-05:00","created_by":"ubuntu"}]}
{"id":"meow-d1h","title":"Prioritize orchestrator beads in ready selection","description":"Update GetNextReady to prioritize by tier per SPEC-ADDENDUM.\n\n## Priority Order\n\n1. **Orchestrator beads** (start, stop, condition, code, expand, gate)\n2. **Wisp beads** (task beads with Tier=wisp)\n3. **Work beads** (task beads with Tier=work)\n\n## Implementation\n\n```go\nfunc (o *Orchestrator) GetNextReady(ctx context.Context) (*types.Bead, error) {\n    ready, _ := o.store.GetReady(ctx, BeadFilter{\n        Statuses: []BeadStatus{StatusOpen},\n    })\n    \n    if len(ready) == 0 {\n        return nil, nil\n    }\n    \n    // Sort by tier priority (orchestrator first)\n    sort.Slice(ready, func(i, j int) bool {\n        return tierPriority(ready[i].Tier) \u003c tierPriority(ready[j].Tier)\n    })\n    \n    return ready[0], nil\n}\n\nfunc tierPriority(tier BeadTier) int {\n    switch tier {\n    case TierOrchestrator:\n        return 0  // Highest priority\n    case TierWisp:\n        return 1\n    case TierWork:\n        return 2\n    default:\n        return 3\n    }\n}\n```\n\n## Why Orchestrator First\n\nOrchestrator beads (start, stop, condition, expand) set up the environment for agent work. They must complete before agents see their tasks:\n- `start` spawns the agent\n- `expand` creates the wisps the agent will execute\n- `condition` determines branching before agent proceeds\n\n## File Location\nModify: `internal/orchestrator/orchestrator.go`\n\n## Acceptance Criteria\n- [ ] GetNextReady sorts by tier\n- [ ] Orchestrator beads processed before wisps\n- [ ] Wisps processed before work beads\n- [ ] Tie-breaker by creation time","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T16:39:24.359113179-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:14:12.377609908-05:00","closed_at":"2026-01-07T18:14:12.377609908-05:00","close_reason":"Consolidated into meow-dax (tier-based bead filtering). Priority selection is part of the unified filtering implementation.","dependencies":[{"issue_id":"meow-d1h","depends_on_id":"meow-0tx","type":"blocks","created_at":"2026-01-07T16:40:07.589396447-05:00","created_by":"ubuntu"},{"issue_id":"meow-d1h","depends_on_id":"meow-p84","type":"blocks","created_at":"2026-01-07T16:40:07.714176873-05:00","created_by":"ubuntu"}]}
{"id":"meow-dax","title":"Implement tier-based bead filtering (consolidated)","description":"Consolidated task merging meow-00g, meow-a85, meow-c32.\n\n## Scope\n\nImplement complete tier-based filtering in one coherent piece:\n\n### 1. Label Conventions (was meow-00g)\nDefine standard labels:\n- `meow:tier:work` / `meow:tier:wisp` / `meow:tier:orchestrator`\n- `meow:workflow:{id}` for workflow instance tracking\n- `meow:ephemeral` (existing, keep for backward compat)\n\n### 2. Filter Types (was meow-a85)\n```go\ntype BeadFilter struct {\n    Tier       BeadTier   // Filter by tier\n    WorkflowID string     // Filter by workflow instance\n    Assignee   string     // Filter by agent\n    Status     BeadStatus // Filter by status\n    HookBead   string     // Filter by linked work bead\n}\n```\n\n### 3. Query Implementation (was meow-c32)\nAdd to BeadStore interface:\n```go\nListByTier(ctx, tier BeadTier) ([]*Bead, error)\nListWispsForAgent(ctx, agentID string) ([]*Bead, error)\nListOrchestrator(ctx, workflowID string) ([]*Bead, error)\n```\n\n### 4. Ready Selection Priority (was meow-d1h)\nOrchestrator beads processed before agent beads:\n```go\nfunc (o *Orchestrator) GetNextReady() *Bead {\n    // 1. Check orchestrator tier first (machinery)\n    // 2. Then wisp tier (agent workflow steps)\n    // 3. Never return work tier from here (agent selects those)\n}\n```\n\n## Files to Modify\n- `internal/types/bead.go` - BeadFilter struct\n- `internal/orchestrator/beadstore.go` - Query methods\n- `internal/orchestrator/orchestrator.go` - Priority selection\n\n## Acceptance Criteria\n- [ ] Label conventions documented\n- [ ] BeadFilter struct with tier field\n- [ ] ListByTier, ListWispsForAgent, ListOrchestrator methods\n- [ ] GetNextReady prioritizes orchestrator \u003e wisp\n- [ ] Unit tests for filtering","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T18:13:47.860295186-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:13:47.860295186-05:00","dependencies":[{"issue_id":"meow-dax","depends_on_id":"meow-bba","type":"blocks","created_at":"2026-01-07T18:14:04.228144733-05:00","created_by":"ubuntu"},{"issue_id":"meow-dax","depends_on_id":"meow-cac","type":"blocks","created_at":"2026-01-07T18:15:49.102576601-05:00","created_by":"ubuntu"}]}
{"id":"meow-db2","title":"Add hooked status for wisp beads","description":"New BeadStatusHooked for when agent claims wisp step. See IMPLEMENTATION-PLAN section meow-modules-types-status.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T16:38:53.088124645-05:00","created_by":"ubuntu","updated_at":"2026-01-07T17:50:04.45127359-05:00","closed_at":"2026-01-07T17:50:04.45127359-05:00","close_reason":"Spec refinement: No hooked status. The SPEC-ADDENDUM-WISPS-AND-MODULES.md explicitly removes the hooked status (lines 179-210). Three statuses only: open, in_progress, closed. Use LastSeen timestamp for heartbeat tracking if needed."}
{"id":"meow-dvr","title":"Implement external reference resolution","description":"Resolve file#workflow external references with cycle detection. See IMPLEMENTATION-PLAN section meow-modules-loader-external.","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T16:39:05.509975604-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:17:49.635081236-05:00","dependencies":[{"issue_id":"meow-dvr","depends_on_id":"meow-m3k","type":"blocks","created_at":"2026-01-07T16:39:46.972207258-05:00","created_by":"ubuntu"}]}
{"id":"meow-e1","title":"Foundation: Project setup and core infrastructure","description":"Establish the foundational infrastructure for MEOW Stack including project\nstructure, core types, CLI skeleton, and build system.\n","notes":"## Why This Epic Matters\n\nA solid foundation prevents technical debt. Every component depends on\nthese core types and patterns. Getting this right saves refactoring later.\n\n## Deliverables\n1. Go project structure with modules\n2. Core types (Bead, Agent, Template, Config)\n3. CLI skeleton using Cobra\n4. Build system (Makefile)\n5. Basic configuration handling\n\n## Success Criteria\n- `go build` produces working `meow` binary\n- `meow --version` and `meow --help` work\n- Core types are defined and usable\n- Basic project structure matches architecture doc\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.457391798-05:00","updated_at":"2026-01-07T05:07:01.620295717-05:00","closed_at":"2026-01-07T05:07:01.620295717-05:00","close_reason":"Foundation epic complete: Go project structure, core types (Bead/Agent/Config), CLI skeleton with Cobra, Makefile build system, config loading, structured logging, error types. All tests pass, binary builds and runs.","labels":["epic","foundation","phase-1"]}
{"id":"meow-e1.1","title":"Initialize Go project with module structure","description":"Create the Go project structure for MEOW Stack.","notes":"## Directory Structure\n```\nmeow-machine/\n├── cmd/meow/                  # CLI entry point\n├── internal/\n│   ├── config/               # Configuration handling\n│   ├── types/                # Core data types\n│   ├── orchestrator/         # Orchestrator engine\n│   ├── template/             # Template system\n│   ├── agent/                # Agent management\n│   └── primitive/            # Primitive handlers\n├── pkg/meow/                 # Public API (if needed)\n├── templates/                # Default templates (embedded)\n├── go.mod\n├── Makefile\n└── README.md\n```\n\n## Commands\n```bash\ngo mod init github.com/your-org/meow-machine\nmkdir -p cmd/meow internal/{config,types,orchestrator,template,agent,primitive}\n```\n\n## Acceptance Criteria\n- [ ] `go mod init` creates valid go.mod\n- [ ] Directory structure matches plan\n- [ ] `.gitignore` includes Go artifacts\n- [ ] Basic `main.go` compiles\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:21:57.587121961-05:00","closed_at":"2026-01-07T03:21:57.587121961-05:00","close_reason":"Go project initialized with module structure, .gitignore, and compiling main.go","labels":["foundation","setup"]}
{"id":"meow-e1.2","title":"Define core data types (Bead, Agent, Template, Config)","description":"Define the fundamental data structures used throughout MEOW.","notes":"## Types to Define\n\n### Bead (internal/types/bead.go)\n- BeadType enum (task, condition, stop, start, code, expand) - 6 primitives\n- BeadStatus enum (open, in_progress, closed)\n- Bead struct with all fields\n- Primitive-specific spec structs (ConditionSpec, StartSpec, CodeSpec, etc.)\n- OutputSpec for code bead outputs (stdout, file capture)\n- TaskOutputSpec for required/optional task outputs with types\n- EphemeralFlag for cleanup behavior\n\n### Agent (internal/types/agent.go)\n- AgentStatus enum (active, stopped)\n- Agent struct with session tracking\n- Session ID storage (for resume composition)\n\n### Config (internal/config/config.go)\n- Config struct for TOML loading\n- DefaultsConfig for default values\n- EphemeralCleanup settings\n\n## Design Decisions\n\n**Why 6 primitives instead of 8?**\ncheckpoint and resume are now composed from code + start:\n- checkpoint → code bead running `meow session-id`\n- resume → start bead with `resume_session` parameter\n\n**Why separate spec structs?**\nEach primitive has different fields. Using embedded structs keeps the\nmain Bead type clean while allowing type-safe access.\n\n## Acceptance Criteria\n- [ ] All types compile without errors\n- [ ] JSON marshaling/unmarshaling works correctly\n- [ ] OutputSpec handles stdout, stderr, file capture\n- [ ] TaskOutputSpec handles required/optional with types\n- [ ] Types have appropriate comments/godoc\n- [ ] Unit tests for marshaling edge cases\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:25:40.677515046-05:00","closed_at":"2026-01-07T03:25:40.677515046-05:00","close_reason":"Core types defined: Bead (6 primitives), Agent, Config with full test coverage","labels":["foundation","types"],"dependencies":[{"issue_id":"meow-e1.2","depends_on_id":"meow-e1.1","type":"blocks","created_at":"2026-01-07T03:14:29.867045093-05:00","created_by":"ubuntu"}]}
{"id":"meow-e1.3","title":"Create CLI skeleton with Cobra","description":"Set up the CLI framework using Cobra with stub commands.","notes":"## Commands to Stub\n\n### User Commands\n- `meow init` - Initialize .meow directory\n- `meow run \u003ctemplate\u003e` - Start workflow\n- `meow status` - Show current state\n- `meow approve [bead]` - Approve a gate\n- `meow reject [bead]` - Reject a gate\n\n### Agent Commands\n- `meow prime` - Show next task for agent\n- `meow close \u003cbead\u003e` - Close a task\n- `meow handoff` - Request context refresh\n\n### Debug Commands\n- `meow agents` - List agents\n- `meow trace` - Show execution trace\n- `meow validate \u003ctemplate\u003e` - Validate template\n\n## File Structure\n```\ncmd/meow/\n├── main.go\n├── root.go\n├── init.go\n├── run.go\n└── ...\n```\n\n## Acceptance Criteria\n- [ ] `meow --help` shows all commands\n- [ ] `meow \u003ccmd\u003e --help` shows command-specific help\n- [ ] `meow --version` shows version\n- [ ] Commands parse arguments correctly\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:36:45.583611903-05:00","closed_at":"2026-01-07T03:36:45.583611903-05:00","close_reason":"CLI skeleton with Cobra: init, run, status, approve, reject, prime, close, handoff, agents, trace, validate","labels":["cli","foundation"],"dependencies":[{"issue_id":"meow-e1.3","depends_on_id":"meow-e1.1","type":"blocks","created_at":"2026-01-07T03:14:29.973239873-05:00","created_by":"ubuntu"}]}
{"id":"meow-e1.4","title":"Create Makefile and build scripts","description":"Create build automation for the project.","notes":"## Makefile Targets\n- `build` - Build binary to bin/meow\n- `install` - Install to GOPATH/bin\n- `test` - Run all tests\n- `test-short` - Run short tests\n- `lint` - Run golangci-lint\n- `clean` - Remove artifacts\n- `generate` - Run go generate\n\n## Version Embedding\nUse ldflags to embed version from git tags:\n```makefile\nVERSION ?= $(shell git describe --tags --always --dirty)\nLDFLAGS := -ldflags \"-X main.version=$(VERSION)\"\n```\n\n## Acceptance Criteria\n- [ ] `make build` produces binary\n- [ ] `make test` runs tests\n- [ ] `make lint` runs linter\n- [ ] Version embedded correctly\n","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T05:03:38.056255802-05:00","closed_at":"2026-01-07T05:03:38.056255802-05:00","close_reason":"Makefile created with all targets: build, install, test, test-short, test-cover, lint, fmt, vet, tidy, generate, clean, run, version, check, help. Version embedding works via ldflags.","labels":["build","foundation"],"dependencies":[{"issue_id":"meow-e1.4","depends_on_id":"meow-e1.1","type":"blocks","created_at":"2026-01-07T03:14:30.059554844-05:00","created_by":"ubuntu"}]}
{"id":"meow-e1.5","title":"Implement configuration loading and defaults","description":"Implement configuration file loading and sensible defaults.","notes":"## Config File Locations (priority order)\n1. `.meow/config.toml` (project-local)\n2. `~/.config/meow/config.toml` (user global)\n3. Built-in defaults\n\n## Default Configuration\n```toml\nversion = \"1\"\n\n[paths]\ntemplate_dir = \".meow/templates\"\nbeads_dir = \".beads\"\nstate_dir = \".meow/state\"\n\n[defaults]\nagent = \"claude-1\"\nstop_grace_period = 10\ncondition_timeout = \"1h\"\n\n[orchestrator]\npoll_interval = \"100ms\"\nheartbeat_interval = \"30s\"\n\n[cleanup]\nephemeral = \"on_complete\"  # on_complete | manual | never\n\n[logging]\nlevel = \"info\"  # debug | info | warn | error\nformat = \"json\"  # json | text\nfile = \".meow/state/meow.log\"\n```\n\n## Acceptance Criteria\n- [ ] Default config works with no file present\n- [ ] Project-local config overrides defaults\n- [ ] Unknown fields ignored (forward compatibility)\n- [ ] Invalid config produces helpful error\n- [ ] Unit tests for config loading edge cases\n","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T05:02:16.005808874-05:00","closed_at":"2026-01-07T05:02:16.005808874-05:00","close_reason":"Configuration loading fully implemented with Load, LoadFromDir, Validate, path helpers, and comprehensive test coverage","labels":["config","foundation"],"dependencies":[{"issue_id":"meow-e1.5","depends_on_id":"meow-e1.2","type":"blocks","created_at":"2026-01-07T03:14:30.149720604-05:00","created_by":"ubuntu"}]}
{"id":"meow-e1.6","title":"Implement structured logging infrastructure","description":"Set up structured logging for debugging and observability.","notes":"## Why Logging Matters\nMEOW orchestrates long-running workflows. When things go wrong, we need:\n- Clear timestamps for every action\n- Structured fields for filtering (agent, bead_id, action)\n- Log levels for verbosity control\n- File output for post-mortem analysis\n\n## Implementation\nUse zerolog or zap for structured JSON logging.\n\n## Log Levels\n- DEBUG: Variable substitution, bead state changes\n- INFO: Bead dispatch, agent spawn/stop, template expansion\n- WARN: Retries, timeouts, missing optional fields\n- ERROR: Validation failures, crashes, unrecoverable states\n\n## Log Fields (always include)\n```json\n{\n  \"ts\": \"2026-01-07T12:00:00Z\",\n  \"level\": \"info\",\n  \"msg\": \"Dispatching bead\",\n  \"bead_id\": \"bd-task-001\",\n  \"bead_type\": \"task\",\n  \"agent\": \"claude-1\",\n  \"workflow_id\": \"meow-run-001\"\n}\n```\n\n## Acceptance Criteria\n- [ ] Logger initialized from config\n- [ ] All major actions logged with context\n- [ ] Log rotation (max file size)\n- [ ] DEBUG level shows internal state\n- [ ] JSON format parseable by jq\n- [ ] Unit tests for log output format\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T05:06:33.648484168-05:00","closed_at":"2026-01-07T05:06:33.648484168-05:00","close_reason":"Structured logging infrastructure implemented: NewFromConfig for config-based initialization, file output with directory creation, JSON/text formats, level parsing, context helpers (WithWorkflow, WithBead, WithAgent), comprehensive test coverage","labels":["foundation","logging"],"dependencies":[{"issue_id":"meow-e1.6","depends_on_id":"meow-e1.5","type":"blocks","created_at":"2026-01-07T03:14:30.240051401-05:00","created_by":"ubuntu"}]}
{"id":"meow-e1.7","title":"Define error types and codes","description":"Define structured error types for consistent error handling.","notes":"## Error Categories\n- **ConfigError**: Invalid config, missing required fields\n- **TemplateError**: Parse error, validation error, missing template\n- **BeadError**: Invalid state transition, missing dependency, cycle\n- **AgentError**: Spawn failed, session not found, timeout\n- **OutputError**: Type mismatch, missing required, validation failed\n- **IOError**: File not found, permission denied, disk full\n\n## Error Structure\n```go\ntype MeowError struct {\n    Code    string   // \"TMPL_PARSE_001\"\n    Message string   // Human-readable\n    Details map[string]any  // Context\n    Cause   error    // Wrapped error\n}\n```\n\n## Error Codes\n```\nCONFIG_001: Missing required field\nCONFIG_002: Invalid value type\nTMPL_001: Parse error\nTMPL_002: Validation error - missing field\nTMPL_003: Validation error - cycle detected\nBEAD_001: Invalid status transition\nBEAD_002: Dependency not satisfied\nAGENT_001: Session spawn failed\nAGENT_002: Session not found\nOUTPUT_001: Missing required output\nOUTPUT_002: Type validation failed\nOUTPUT_003: Bead ID not found\n```\n\n## Acceptance Criteria\n- [ ] All error types defined\n- [ ] Errors include context (bead_id, template, etc.)\n- [ ] Errors are JSON-serializable\n- [ ] CLI shows human-readable messages\n- [ ] Unit tests for error formatting\n","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T05:05:11.408690241-05:00","closed_at":"2026-01-07T05:05:11.408690241-05:00","close_reason":"Error types defined: MeowError struct with Code/Message/Details/Cause, all error codes (CONFIG, TMPL, BEAD, AGENT, OUTPUT, IO), factory functions for each error type, JSON serialization, Is/Code helpers, comprehensive test coverage","labels":["errors","foundation"],"dependencies":[{"issue_id":"meow-e1.7","depends_on_id":"meow-e1.2","type":"blocks","created_at":"2026-01-07T03:14:30.320856018-05:00","created_by":"ubuntu"}]}
{"id":"meow-e10","title":"CLI Completion: All commands","description":"Complete all CLI commands.","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T03:12:48.457391798-05:00","updated_at":"2026-01-07T03:12:48.457391798-05:00","labels":["cli","epic","phase-4"],"dependencies":[{"issue_id":"meow-e10","depends_on_id":"meow-e3","type":"blocks","created_at":"2026-01-07T03:14:35.199949701-05:00","created_by":"ubuntu"},{"issue_id":"meow-e10","depends_on_id":"meow-e4","type":"blocks","created_at":"2026-01-07T03:14:35.288380895-05:00","created_by":"ubuntu"},{"issue_id":"meow-e10","depends_on_id":"meow-e5","type":"blocks","created_at":"2026-01-07T03:14:35.379231928-05:00","created_by":"ubuntu"}]}
{"id":"meow-e10.1","title":"Implement meow init command","description":"Initialize .meow directory.","notes":"- Create directory structure\n- Copy default templates\n- Create config.toml\n- Setup Claude Code hooks\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T20:39:40.477442716-05:00","closed_at":"2026-01-07T20:39:40.477442716-05:00","close_reason":"Implemented meow init with embedded templates (simple, tdd), Claude Code hooks setup, .beads directory creation, and configurable flags (--hooks, --skip-templates).","labels":["cli","init"]}
{"id":"meow-e10.2","title":"Implement meow run command","description":"Start workflow execution.","notes":"Usage: meow run \u003ctemplate\u003e [--var key=value]...\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T19:29:21.045542964-05:00","closed_at":"2026-01-07T19:29:21.045542964-05:00","close_reason":"Implemented meow run command with template parsing, baking, and bead store integration. Supports --dry-run, --var, and --workflow flags.","labels":["cli","run"],"dependencies":[{"issue_id":"meow-e10.2","depends_on_id":"meow-e3.4","type":"blocks","created_at":"2026-01-07T03:14:35.470072244-05:00","created_by":"ubuntu"}]}
{"id":"meow-e10.3","title":"Implement meow prime command","description":"Show next task for agent with required outputs.","notes":"## Behavior\n1. Read $MEOW_AGENT to identify current agent\n2. Find assigned ready bead\n3. Output formatted context including:\n   - Task title and description\n   - **Required outputs with types and descriptions**\n   - Example close command\n   - Recently completed beads (optional context)\n\n## Output Format\n```\n=== YOUR CURRENT TASK ===\nBead: bd-select-001\nTitle: Select next task to work on\n\nInstructions:\n  Run: bv --robot-triage\n  Pick the highest priority ready task.\n\nREQUIRED OUTPUTS when closing:\n  work_bead (bead_id): The bead ID to implement\n  rationale (string): Why you chose this bead\n\nExample:\n  meow close bd-select-001 \\\n    --output work_bead=bd-task-XXX \\\n    --output rationale=\"...\"\n\nRECENTLY COMPLETED:\n  bd-task-000 \"Setup project\" (closed 5m ago)\n```\n\n## Acceptance Criteria\n- [ ] Reads agent from environment\n- [ ] Finds ready bead for agent\n- [ ] Shows task details\n- [ ] **Shows required outputs if defined**\n- [ ] Shows example close command\n- [ ] Shows recently completed beads (optional)\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T18:13:03.758900727-05:00","closed_at":"2026-01-07T18:13:03.758900727-05:00","close_reason":"Superseded by meow-97m (wisp-aware meow prime). Implementing basic prime first then rewriting for wisps is wasteful - go directly to wisp-aware version.","labels":["cli","prime"],"dependencies":[{"issue_id":"meow-e10.3","depends_on_id":"meow-e7.4","type":"blocks","created_at":"2026-01-07T03:14:35.560130626-05:00","created_by":"ubuntu"}]}
{"id":"meow-e10.4","title":"Implement meow close command","description":"Close a task bead with optional validated outputs.","notes":"## Usage\n```bash\nmeow close \u003cbead-id\u003e\nmeow close \u003cbead-id\u003e --notes \"...\"\nmeow close \u003cbead-id\u003e --output key=value --output key2=value2\nmeow close \u003cbead-id\u003e --output-json '{\"key\": \"value\"}'\n```\n\n## Output Validation\nIf the bead has required outputs defined, the close command must:\n1. Check all required outputs are provided\n2. Validate output types (string, bead_id, file_path, etc.)\n3. Return error with helpful message if validation fails\n4. Store validated outputs on the bead\n\n## Example Error\n```\nError: Cannot close bd-select-001 - missing required outputs\n\nRequired outputs:\n  ✗ work_bead (bead_id): Not provided\n  ✗ rationale (string): Not provided\n\nUsage:\n  meow close bd-select-001 --output work_bead=\u003cbead_id\u003e --output rationale=\u003cstring\u003e\n```\n\n## Acceptance Criteria\n- [ ] Closes bead with status update\n- [ ] Supports --notes flag\n- [ ] **Supports --output key=value flags**\n- [ ] **Supports --output-json for complex outputs**\n- [ ] **Validates required outputs before closing**\n- [ ] **Returns helpful error for missing/invalid outputs**\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T18:13:05.884935639-05:00","closed_at":"2026-01-07T18:13:05.884935639-05:00","close_reason":"Superseded by meow-74h (meow close with output validation). The wisp-aware version is the real target - no point implementing a simpler version first.","labels":["cli","close"]}
{"id":"meow-e10.5","title":"Implement meow status command","description":"Show comprehensive workflow status.","notes":"## Usage\n```bash\nmeow status                 # Current workflow status\nmeow status --verbose       # Include all beads\nmeow status --json          # JSON output for scripting\nmeow status --watch         # Live updates\n```\n\n## Output Format\n```\n=== MEOW WORKFLOW STATUS ===\nWorkflow: work-loop (started 2h ago)\nTemplate: work-loop.toml\n\nAGENTS:\n  claude-1        active     (running for 45m)\n  claude-1-worker stopped    (completed 10m ago)\n\nBEADS:\n  Total: 15  Open: 3  In Progress: 1  Closed: 11\n\n  Currently executing:\n    → bd-task-005 \"Implement auth endpoint\" (claude-1, 5m)\n\n  Ready to execute:\n    • bd-task-006 \"Write integration tests\"\n    • bd-task-007 \"Update documentation\"\n\n  Recently closed:\n    ✓ bd-task-004 \"Setup database\" (2m ago)\n    ✓ bd-task-003 \"Create models\" (15m ago)\n\nOUTPUTS (recent):\n  select-task.work_bead = \"bd-task-005\"\n  setup-worktree.path = \".meow/worktrees/worker\"\n\nHEALTH:\n  Orchestrator: running (heartbeat 5s ago)\n  Lock: held by PID 12345\n```\n\n## Acceptance Criteria\n- [ ] Shows agent status\n- [ ] Shows bead counts and states\n- [ ] Shows currently executing beads\n- [ ] Shows recent outputs\n- [ ] --json produces parseable output\n- [ ] --watch updates live\n","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["cli","status"]}
{"id":"meow-e10.6","title":"Implement debug commands","description":"agents, beads, trace, peek, clean commands.","notes":"## Commands\n- `meow agents [--active]` - List agents and states\n- `meow beads [--ready] [--include-ephemeral]` - List beads\n- `meow trace [--follow]` - Show execution trace\n- `meow peek \u003cagent\u003e` - Show agent's current output\n- `meow attach \u003cagent\u003e` - Attach to tmux session\n- `meow clean --ephemeral` - Clean up ephemeral beads\n\n## --include-ephemeral Flag\nBy default, beads with `meow:ephemeral` label are hidden.\nThis keeps focus on work beads, not workflow machinery.\n\n## Acceptance Criteria\n- [ ] All debug commands work\n- [ ] Ephemeral beads hidden by default\n- [ ] --include-ephemeral shows all beads\n- [ ] meow clean --ephemeral removes closed ephemeral beads\n","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["cli","debug"]}
{"id":"meow-e11","title":"Comprehensive Testing: Unit, Integration, and E2E","description":"Comprehensive test coverage including unit tests, integration tests, and\nend-to-end tests with mock Claude. This epic is CRITICAL for reliability.\n","notes":"## Why This Epic is Non-Negotiable\nMEOW orchestrates long-running AI workflows. Bugs can waste hours of compute\nand cause data loss. We need:\n- Unit tests for every component\n- Integration tests for component interactions\n- E2E tests simulating real workflows\n- Detailed logging for debugging test failures\n\n## Phased Testing Strategy\nTesting is NOT a Phase 4 afterthought. Tests are written alongside code:\n\n| Test Type | Phase | Dependencies |\n|-----------|-------|--------------|\n| Test infrastructure (e11.1) | Phase 2 | E1 (types) |\n| Unit tests (e11.2-e11.5) | Phase 2 | Respective components |\n| Integration tests (e11.6) | Phase 3 | Core primitives |\n| E2E tests (e11.7) | Phase 4 | CLI + full system |\n| Performance (e11.8) | Phase 4 | Full system |\n\n## Test Categories\n1. **Unit Tests**: Individual functions and types (write with component)\n2. **Integration Tests**: Component interactions (write after primitives)\n3. **E2E Tests**: Full workflow execution with mock Claude (write after CLI)\n4. **Stress Tests**: Performance under load (final phase)\n\n## Coverage Requirements\n- Minimum 80% line coverage\n- 100% coverage for critical paths (output validation, bead transitions)\n","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.457391798-05:00","updated_at":"2026-01-07T03:12:48.457391798-05:00","labels":["critical","epic","testing"]}
{"id":"meow-e11.1","title":"Create test infrastructure and fixtures","description":"Set up testing infrastructure, fixtures, and helpers.","notes":"## Test Infrastructure\n\n### Directory Structure\n```\ninternal/testutil/\n├── fixtures.go      # Test data factories\n├── mock_tmux.go     # Mock tmux for agent tests\n├── mock_claude.go   # Mock Claude responses\n├── assertions.go    # Custom assertions\n├── logger.go        # Test logger that captures output\n└── cleanup.go       # Test cleanup helpers\n```\n\n### Test Fixtures\n```go\n// Create test beads\nfunc NewTestBead(t *testing.T, beadType string) *types.Bead\nfunc NewTestTemplate(t *testing.T, name string) *template.Template\nfunc NewTestConfig(t *testing.T) *config.Config\n\n// Create temp directories\nfunc NewTestWorkspace(t *testing.T) (path string, cleanup func())\n\n// Mock tmux\nfunc NewMockTmux(t *testing.T) *MockTmux\n```\n\n### Mock Claude\nScript that simulates Claude Code behavior:\n```bash\n#!/bin/bash\n# mock_claude.sh - Simulates Claude Code for testing\n# Reads meow prime, executes predefined responses, runs meow close\n\ncase \"$1\" in\n  --dangerously-skip-permissions)\n    # Enter mock REPL\n    while read -r line; do\n      if [[ \"$line\" == \"meow prime\" ]]; then\n        # Simulate Claude reading task and closing\n        BEAD_ID=$(meow prime --format json | jq -r .bead_id)\n        sleep 0.1\n        meow close \"$BEAD_ID\" --notes \"Mock completed\"\n      fi\n    done\n    ;;\nesac\n```\n\n### Test Logger\n```go\n// Captures structured logs for assertion\ntype TestLogger struct {\n    Entries []LogEntry\n}\n\nfunc (l *TestLogger) AssertContains(t *testing.T, msg string)\nfunc (l *TestLogger) AssertLevel(t *testing.T, level string, count int)\n```\n\n## Acceptance Criteria\n- [ ] Test fixtures create valid test data\n- [ ] Mock tmux simulates session lifecycle\n- [ ] Mock Claude script runs and responds\n- [ ] Test logger captures structured output\n- [ ] Cleanup removes all temp files\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T14:23:53.479373615-05:00","closed_at":"2026-01-07T14:23:53.479373615-05:00","close_reason":"Closed","labels":["infrastructure","phase-2","testing"],"dependencies":[{"issue_id":"meow-e11.1","depends_on_id":"meow-e1.2","type":"blocks","created_at":"2026-01-07T03:14:35.647890862-05:00","created_by":"ubuntu"}]}
{"id":"meow-e11.10","title":"Create example workflows","description":"Complete example projects demonstrating MEOW capabilities.","notes":"## Example Projects\n```\nexamples/\n├── hello-world/           # Simplest possible workflow\n├── tdd-implementation/    # TDD with implement template\n├── multi-agent/           # Parent/child with call template\n├── human-approval/        # Human gate workflow\n└── context-aware/         # Context checking and refresh\n```\n\n## Each Example Includes\n- README with explanation\n- Complete template files\n- Expected output/trace\n- Troubleshooting tips\n\n## Acceptance Criteria\n- [ ] Each example runs standalone\n- [ ] Examples tested in CI\n- [ ] README explains what happens\n","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["docs","examples"]}
{"id":"meow-e11.2","title":"Unit tests for core types","description":"Unit tests for Bead, Agent, Config, and Template types.","notes":"## Test Files\n- internal/types/bead_test.go\n- internal/types/agent_test.go\n- internal/config/config_test.go\n- internal/template/template_test.go\n\n## Test Cases\n\n### Bead Tests\n- [ ] JSON marshaling/unmarshaling round-trip\n- [ ] Status transitions (open → in_progress → closed)\n- [ ] Invalid status transition errors\n- [ ] Output storage and retrieval\n- [ ] Ephemeral label detection\n- [ ] Dependency parsing\n\n### Agent Tests\n- [ ] State transitions (active → stopped)\n- [ ] Session ID storage\n- [ ] Environment variable generation\n\n### Config Tests\n- [ ] Default values applied\n- [ ] File override works\n- [ ] Unknown fields ignored\n- [ ] Invalid values error with context\n\n### Template Tests\n- [ ] TOML parsing\n- [ ] Variable definition parsing\n- [ ] Step dependency parsing\n- [ ] Output spec parsing\n\n## Acceptance Criteria\n- [ ] All types have \u003e90% coverage\n- [ ] Edge cases covered (empty, nil, max values)\n- [ ] Error messages tested\n","status":"in_progress","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-08T01:05:47.084123617-05:00","labels":["phase-2","testing","unit"],"dependencies":[{"issue_id":"meow-e11.2","depends_on_id":"meow-e11.1","type":"blocks","created_at":"2026-01-07T03:14:35.733868852-05:00","created_by":"ubuntu"},{"issue_id":"meow-e11.2","depends_on_id":"meow-e1.2","type":"blocks","created_at":"2026-01-07T03:14:35.823298363-05:00","created_by":"ubuntu"}]}
{"id":"meow-e11.3","title":"Unit tests for template system","description":"Unit tests for template parsing, validation, and baking.","notes":"## Test Files\n- internal/template/parser_test.go\n- internal/template/validator_test.go\n- internal/template/variables_test.go\n- internal/template/baker_test.go\n\n## Test Cases\n\n### Parser Tests\n- [ ] Valid template parses correctly\n- [ ] Invalid TOML returns parse error with line number\n- [ ] All step types parsed correctly\n- [ ] Inline expansion targets parsed\n- [ ] Template expansion targets parsed\n- [ ] Output specs parsed\n\n### Validator Tests\n- [ ] Missing meta.name errors\n- [ ] Duplicate step IDs error\n- [ ] Invalid step type errors\n- [ ] Circular dependencies detected\n- [ ] Missing needs references detected\n- [ ] Undefined variable references detected\n- [ ] Type mismatches detected\n\n### Variable Substitution Tests\n- [ ] Basic {{var}} substitution\n- [ ] Nested {{a.b.c}} access\n- [ ] Output reference {{bead.outputs.field}}\n- [ ] Built-in variables ({{agent}}, {{timestamp}})\n- [ ] Missing required variable errors\n- [ ] Default values applied\n- [ ] Recursive substitution detected and errors\n\n### Baker Tests\n- [ ] Simple template bakes to correct beads\n- [ ] Dependencies translated to bead IDs\n- [ ] Inline steps become child beads\n- [ ] Ephemeral flag propagates\n- [ ] Output references preserved for runtime\n\n## Acceptance Criteria\n- [ ] Template system has \u003e90% coverage\n- [ ] All error paths tested\n- [ ] Performance: 1000 templates parse in \u003c1s\n","status":"in_progress","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-08T01:05:47.152370326-05:00","labels":["phase-2","testing","unit"],"dependencies":[{"issue_id":"meow-e11.3","depends_on_id":"meow-e11.1","type":"blocks","created_at":"2026-01-07T03:14:35.910711208-05:00","created_by":"ubuntu"},{"issue_id":"meow-e11.3","depends_on_id":"meow-e2","type":"blocks","created_at":"2026-01-07T03:14:35.999393122-05:00","created_by":"ubuntu"}]}
{"id":"meow-e11.4","title":"Unit tests for primitive handlers","description":"Unit tests for all 6 primitive handlers.","notes":"## Test Files\n- internal/primitive/task_test.go\n- internal/primitive/condition_test.go\n- internal/primitive/code_test.go\n- internal/primitive/expand_test.go\n- internal/primitive/start_test.go\n- internal/primitive/stop_test.go\n\n## Test Cases\n\n### Task Handler Tests\n- [ ] Waits for bead to close\n- [ ] Validates required outputs\n- [ ] Rejects invalid output types\n- [ ] Stores validated outputs\n- [ ] Handles agent death\n\n### Condition Handler Tests\n- [ ] Exit 0 expands on_true\n- [ ] Exit non-0 expands on_false\n- [ ] Timeout expands on_timeout\n- [ ] Runs in goroutine (non-blocking)\n- [ ] Cancellation works\n\n### Code Handler Tests\n- [ ] Executes shell command\n- [ ] Captures stdout to output\n- [ ] Captures stderr to output\n- [ ] Reads file to output\n- [ ] Handles on_error: continue\n- [ ] Handles on_error: abort\n- [ ] Handles on_error: retry\n\n### Expand Handler Tests\n- [ ] Loads template\n- [ ] Substitutes variables\n- [ ] Resolves output references\n- [ ] Creates child beads\n- [ ] Sets ephemeral labels\n- [ ] Wires dependencies\n\n### Start Handler Tests\n- [ ] Creates tmux session\n- [ ] Sets workdir from output reference\n- [ ] Fresh start works\n- [ ] Resume with session_id works\n- [ ] Injects meow prime\n\n### Stop Handler Tests\n- [ ] Graceful stop sends interrupt\n- [ ] Force kill after timeout\n- [ ] Works if session doesn't exist\n- [ ] Updates agent state\n\n## Acceptance Criteria\n- [ ] Each handler has \u003e90% coverage\n- [ ] All error conditions tested\n- [ ] Mock tmux used (no real sessions)\n","status":"in_progress","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-08T01:05:47.223933495-05:00","labels":["phase-2","testing","unit"],"dependencies":[{"issue_id":"meow-e11.4","depends_on_id":"meow-e11.1","type":"blocks","created_at":"2026-01-07T03:14:36.089044935-05:00","created_by":"ubuntu"},{"issue_id":"meow-e11.4","depends_on_id":"meow-e4","type":"blocks","created_at":"2026-01-07T03:14:36.178016699-05:00","created_by":"ubuntu"}]}
{"id":"meow-e11.5","title":"Unit tests for output binding","description":"Unit tests for output capture, storage, and resolution.","notes":"## Test Files\n- internal/output/capture_test.go\n- internal/output/storage_test.go\n- internal/output/resolver_test.go\n- internal/output/validator_test.go\n\n## Test Cases\n\n### Output Capture Tests\n- [ ] Captures stdout (trimmed)\n- [ ] Captures stderr (trimmed)\n- [ ] Reads file contents\n- [ ] Handles missing file gracefully\n- [ ] Handles empty output\n\n### Output Storage Tests\n- [ ] Stores outputs on bead\n- [ ] Persists across save/load\n- [ ] Visible in bd show\n\n### Output Resolver Tests\n- [ ] Resolves {{bead.outputs.field}}\n- [ ] Errors on non-existent bead\n- [ ] Errors on unclosed bead\n- [ ] Errors on missing field\n- [ ] Suggests similar beads on typo\n\n### Output Validator Tests\n- [ ] string type validation\n- [ ] number type validation\n- [ ] boolean type validation\n- [ ] bead_id type validation (checks existence)\n- [ ] file_path type validation (checks existence)\n- [ ] string[] type validation\n- [ ] json type validation\n- [ ] Error messages include expected type\n\n## Acceptance Criteria\n- [ ] All output types have validation tests\n- [ ] Error messages are helpful\n- [ ] Edge cases covered (empty, null, unicode)\n","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["outputs","phase-2","testing","unit"],"dependencies":[{"issue_id":"meow-e11.5","depends_on_id":"meow-e11.1","type":"blocks","created_at":"2026-01-07T03:14:36.269736743-05:00","created_by":"ubuntu"},{"issue_id":"meow-e11.5","depends_on_id":"meow-e7","type":"blocks","created_at":"2026-01-07T03:14:36.359893174-05:00","created_by":"ubuntu"}]}
{"id":"meow-e11.6","title":"Integration tests for orchestrator","description":"Integration tests for orchestrator main loop and state management.","notes":"## Test Files\n- internal/orchestrator/integration_test.go\n\n## Test Scenarios\n\n### Basic Execution\n- [ ] Simple linear workflow (3 code beads)\n- [ ] Workflow with dependencies (diamond pattern)\n- [ ] Workflow completes when all beads closed\n\n### State Management\n- [ ] State persists across loop iterations\n- [ ] Crash recovery resumes from last state\n- [ ] Lock prevents concurrent orchestrators\n- [ ] Heartbeat updates regularly\n\n### Bead Transitions\n- [ ] open → in_progress → closed\n- [ ] Dependency blocking works\n- [ ] Ready detection is correct\n\n### Logging\n- [ ] All dispatch actions logged\n- [ ] Log includes bead_id, agent, type\n- [ ] Errors logged with context\n\n## Test Setup\n```go\nfunc TestOrchestrator_LinearWorkflow(t *testing.T) {\n    workspace := testutil.NewTestWorkspace(t)\n    defer workspace.Cleanup()\n\n    // Create test beads\n    beads := []types.Bead{\n        testutil.NewCodeBead(\"step1\", \"echo hello\"),\n        testutil.NewCodeBead(\"step2\", \"echo world\", \"step1\"),\n        testutil.NewCodeBead(\"step3\", \"echo done\", \"step2\"),\n    }\n\n    // Run orchestrator\n    orch := orchestrator.New(testutil.NewTestConfig(t))\n    err := orch.Run(context.Background(), beads)\n\n    require.NoError(t, err)\n    // Assert all beads closed\n}\n```\n\n## Acceptance Criteria\n- [ ] All scenarios pass\n- [ ] No real tmux sessions created\n- [ ] Tests run in \u003c5s\n- [ ] Parallel test execution works\n","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["integration","phase-3","testing"],"dependencies":[{"issue_id":"meow-e11.6","depends_on_id":"meow-e11.2","type":"blocks","created_at":"2026-01-07T03:14:36.452558633-05:00","created_by":"ubuntu"},{"issue_id":"meow-e11.6","depends_on_id":"meow-e11.4","type":"blocks","created_at":"2026-01-07T03:14:36.547568478-05:00","created_by":"ubuntu"}]}
{"id":"meow-e11.7","title":"E2E tests with mock Claude","description":"End-to-end tests simulating real workflows with mock Claude.","notes":"## E2E Test Framework\n\n### Mock Claude Script\n```bash\n# test/mock_claude.sh\n#!/bin/bash\nset -e\n\nLOG_FILE=\"${MEOW_TEST_LOG:-/tmp/mock_claude.log}\"\n\nlog() {\n    echo \"[$(date -Iseconds)] $*\" \u003e\u003e \"$LOG_FILE\"\n}\n\nlog \"Mock Claude started with args: $*\"\n\n# Simulate Claude startup\nsleep 0.2\necho \"Claude Code ready\"\n\n# Wait for prompts\nwhile IFS= read -r line; do\n    log \"Received: $line\"\n\n    if [[ \"$line\" == *\"meow prime\"* ]]; then\n        log \"Executing meow prime\"\n        PRIME_OUTPUT=$(meow prime --format json 2\u003e/dev/null || echo '{}')\n        BEAD_ID=$(echo \"$PRIME_OUTPUT\" | jq -r '.bead_id // empty')\n\n        if [[ -n \"$BEAD_ID\" ]]; then\n            log \"Found bead: $BEAD_ID\"\n\n            # Check for required outputs\n            OUTPUTS=$(echo \"$PRIME_OUTPUT\" | jq -r '.required_outputs // []')\n            OUTPUT_ARGS=\"\"\n\n            if [[ \"$OUTPUTS\" != \"[]\" ]]; then\n                # Generate mock outputs\n                for output in $(echo \"$OUTPUTS\" | jq -r '.[].name'); do\n                    OUTPUT_ARGS=\"$OUTPUT_ARGS --output $output=mock_value\"\n                done\n            fi\n\n            # Close the bead\n            log \"Closing bead: meow close $BEAD_ID $OUTPUT_ARGS\"\n            meow close \"$BEAD_ID\" --notes \"Mock completed\" $OUTPUT_ARGS\n        fi\n    fi\ndone\n```\n\n### E2E Test Scenarios\n```\ntest/e2e/\n├── simple_workflow_test.go      # Linear code beads\n├── condition_branching_test.go  # on_true/on_false\n├── output_passing_test.go       # Code outputs to start\n├── task_outputs_test.go         # Claude provides outputs\n├── parent_child_test.go         # Call template\n├── crash_recovery_test.go       # Kill and resume\n├── human_gate_test.go           # meow approve flow\n└── ephemeral_cleanup_test.go    # Ephemeral bead cleanup\n```\n\n### Test Structure\n```go\nfunc TestE2E_ParentChildOrchestration(t *testing.T) {\n    if testing.Short() {\n        t.Skip(\"Skipping E2E test\")\n    }\n\n    workspace := testutil.NewTestWorkspace(t)\n    defer workspace.Cleanup()\n\n    // Setup mock Claude\n    mockClaude := testutil.NewMockClaude(t)\n    mockClaude.OnTask(\"select-task\", func(b *types.Bead) {\n        return map[string]string{\"work_bead\": \"bd-task-001\"}\n    })\n\n    // Run workflow\n    result := runE2EWorkflow(t, \"work-loop\", map[string]string{\n        \"agent\": \"claude-1\",\n    })\n\n    // Assertions\n    assert.True(t, result.Completed)\n    assert.Equal(t, 3, result.BeadsExecuted)\n    assertLogContains(t, \"Resuming parent\")\n}\n```\n\n## Acceptance Criteria - Infrastructure\n- [ ] Mock Claude script works reliably\n- [ ] Test fixtures create valid test data\n- [ ] Tests complete in \u003c30s each\n- [ ] Detailed logging for debugging failures\n- [ ] No real Claude API calls\n- [ ] Cleanup removes all temp files/sessions\n\n## Acceptance Criteria - Core Scenarios\nEach of these scenarios must pass:\n\n### Simple Workflow (simple_workflow_test.go)\n- [ ] Linear code beads execute in order\n- [ ] Dependencies are respected\n\n### Condition Branching (condition_branching_test.go)\n- [ ] on_true path works\n- [ ] on_false path works\n- [ ] Nested conditions work\n\n### Output Binding (output_passing_test.go)\n- [ ] Code bead captures stdout to output\n- [ ] Start bead uses output reference for workdir\n- [ ] Output values flow correctly between beads\n\n### Task Output Validation (task_outputs_test.go)\n- [ ] Missing required outputs are rejected\n- [ ] Invalid bead_id outputs are rejected with helpful error\n- [ ] Valid outputs are stored and accessible\n- [ ] Subsequent beads can read outputs via {{bead.outputs.field}}\n\n### Parent/Child Orchestration (parent_child_test.go)\n- [ ] call template spawns child correctly\n- [ ] Parent session is saved\n- [ ] Child completes work\n- [ ] Parent resumes with context\n\n### Crash Recovery (crash_recovery_test.go)\n- [ ] Kill orchestrator mid-workflow\n- [ ] State is persisted to disk\n- [ ] Restart resumes from last state\n- [ ] In-progress beads from dead agents reset\n- [ ] No duplicate work done\n\n### Human Gate (human_gate_test.go)\n- [ ] Blocking condition waits for approval\n- [ ] meow approve unblocks correctly\n- [ ] meow reject triggers on_false path\n\n### Ephemeral Cleanup (ephemeral_cleanup_test.go)\n- [ ] Ephemeral beads get correct label\n- [ ] meow clean --ephemeral removes closed ephemeral beads\n- [ ] Non-ephemeral beads are preserved\n","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["critical","e2e","testing"],"dependencies":[{"issue_id":"meow-e11.7","depends_on_id":"meow-e11.6","type":"blocks","created_at":"2026-01-07T03:14:36.639894591-05:00","created_by":"ubuntu"}]}
{"id":"meow-e11.8","title":"Stress tests and performance benchmarks","description":"Performance tests and benchmarks for critical paths.","notes":"## Benchmark Tests\n```\ninternal/benchmark/\n├── template_parse_bench_test.go\n├── bead_dispatch_bench_test.go\n├── output_resolution_bench_test.go\n└── state_persistence_bench_test.go\n```\n\n## Performance Requirements\n| Operation | Target | Max |\n|-----------|--------|-----|\n| Template parse | \u003c1ms | 5ms |\n| Variable substitution | \u003c100µs | 500µs |\n| Bead dispatch | \u003c10ms | 50ms |\n| State save | \u003c50ms | 200ms |\n| Output resolution | \u003c1ms | 5ms |\n\n## Stress Tests\n- [ ] 1000 beads in single workflow\n- [ ] 100 concurrent output references\n- [ ] 50 nested template expansions\n- [ ] Rapid bead state transitions\n\n## Memory Profiling\n- [ ] No memory leaks in long-running workflows\n- [ ] Memory usage stable over 1000 iterations\n\n## Acceptance Criteria\n- [ ] All benchmarks meet targets\n- [ ] No degradation over time\n- [ ] Results logged for CI tracking\n","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["performance","testing"],"dependencies":[{"issue_id":"meow-e11.8","depends_on_id":"meow-e11.6","type":"blocks","created_at":"2026-01-07T03:14:36.732282858-05:00","created_by":"ubuntu"}]}
{"id":"meow-e11.9","title":"Write user documentation","description":"Comprehensive user documentation for MEOW Stack.","notes":"## Documentation Structure\n```\ndocs/\n├── getting-started.md      # Quick start guide\n├── concepts.md             # Core concepts (primitives, templates, outputs)\n├── template-authoring.md   # How to write templates\n├── cli-reference.md        # All CLI commands\n├── output-binding.md       # Output capture and references\n├── troubleshooting.md      # Common issues and solutions\n└── examples/\n    ├── simple-workflow.md\n    ├── parent-child.md\n    └── human-gate.md\n```\n\n## Content Requirements\n- All 6 primitives documented with examples\n- Output binding explained with diagrams\n- Task outputs and validation explained\n- Ephemeral beads explained\n- Error codes and recovery\n\n## Acceptance Criteria\n- [ ] Getting started takes \u003c10 min\n- [ ] All CLI commands documented\n- [ ] Examples are copy-paste runnable\n- [ ] Troubleshooting covers common errors\n","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["docs"]}
{"id":"meow-e2","title":"Template System: Parser, variables, and baking","description":"Parse TOML templates, substitute variables, validate structure, and \"bake\"\ntemplates into beads.\n","notes":"## Why This Epic Matters\n\nTemplates are the \"programs\" in MEOW. They define workflows using the 6\nprimitives. This epic makes templates usable.\n\n## Key Components\n1. TOML parser with template-specific handling\n2. Variable substitution engine (including output references)\n3. Template validation\n4. Baking (template → beads)\n5. Output reference resolution ({{bead.outputs.field}})\n6. Ephemeral flag handling\n\n## Success Criteria\n- Can parse any valid MEOW template\n- Variable substitution works with nesting\n- Output references ({{bead.outputs.field}}) resolve correctly\n- Ephemeral templates get proper labeling\n- Validation catches common errors\n- Baking creates correct beads with dependencies\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.457391798-05:00","updated_at":"2026-01-07T05:09:35.376547788-05:00","closed_at":"2026-01-07T05:09:35.376547788-05:00","close_reason":"Template system complete: TOML parser (ParseFile, ParseString), variable substitution with nesting/output refs, template validation (cycles, deps, types), baker (template to beads), loader (multi-source with priority). All tests pass.","labels":["epic","phase-1","templates"],"dependencies":[{"issue_id":"meow-e2","depends_on_id":"meow-e1","type":"blocks","created_at":"2026-01-07T03:14:30.411886337-05:00","created_by":"ubuntu"}]}
{"id":"meow-e2.1","title":"Implement TOML template parser","description":"Parse MEOW template files from TOML format.","notes":"## Template Structure\n- [meta] section: name, version, description, etc.\n- [variables] section: variable definitions with types/defaults\n- [[steps]] array: workflow steps\n\n## Go Types\n- Template struct\n- TemplateMeta struct\n- VariableDef struct\n- TemplateStep struct\n- ExpansionTarget struct (for on_true/on_false)\n\n## Acceptance Criteria\n- [ ] Parse valid template without error\n- [ ] Return helpful error for invalid TOML\n- [ ] Handle all step types correctly\n- [ ] Support inline and template expansion targets\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T04:22:56.486778599-05:00","closed_at":"2026-01-07T04:22:56.486778599-05:00","close_reason":"Closed","labels":["parser","templates"],"dependencies":[{"issue_id":"meow-e2.1","depends_on_id":"meow-e1.2","type":"blocks","created_at":"2026-01-07T03:14:30.502169754-05:00","created_by":"ubuntu"}]}
{"id":"meow-e2.2","title":"Implement variable substitution engine","description":"Implement {{variable}} substitution throughout templates.","notes":"## Substitution Types\n- Basic: {{task_id}} → value\n- Nested: {{output.step.field}} → nested value\n- **Output references: {{bead_id.outputs.field}} → captured output**\n- Builtins: {{agent}}, {{bead_id}}, {{timestamp}}, etc.\n\n## Output Reference Resolution\nWhen a template references {{some_bead.outputs.field}}:\n1. Find bead with matching ID in same workflow\n2. Look up outputs.field from bead's stored outputs\n3. Substitute the value\n\nThis enables dynamic data flow:\n- code bead captures stdout → subsequent bead uses it\n- task bead validates output → expand bead uses it\n\n## Edge Cases\n- Unset required variable → error\n- Unset optional with default → use default\n- Recursive substitution → detect and error\n- Missing output reference → error with helpful message\n\n## Acceptance Criteria\n- [ ] Basic {{var}} substitution works\n- [ ] Nested {{a.b.c}} access works\n- [ ] **Output references {{bead.outputs.field}} resolve correctly**\n- [ ] Built-in variables populated\n- [ ] Missing required variable errors clearly\n- [ ] Missing output reference errors with bead context\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T04:25:06.053744192-05:00","closed_at":"2026-01-07T04:25:06.053744192-05:00","close_reason":"Closed","labels":["templates","variables"],"dependencies":[{"issue_id":"meow-e2.2","depends_on_id":"meow-e2.1","type":"blocks","created_at":"2026-01-07T03:14:30.591582666-05:00","created_by":"ubuntu"}]}
{"id":"meow-e2.3","title":"Implement template validation","description":"Validate templates for correctness before baking.","notes":"## Validations\n- Structure: meta.name required, unique step IDs, valid types\n- Dependencies: needs references exist, no cycles, all reachable\n- Variables: all {{var}} references defined\n- Type-specific: condition has on_true/on_false, expand has template, etc.\n\n## Error Messages\nShould include:\n- Template name and step ID\n- What's wrong\n- Suggestions (\"did you mean X?\")\n\n## Acceptance Criteria\n- [ ] Catches missing required fields\n- [ ] Detects circular dependencies\n- [ ] Suggests corrections for typos\n- [ ] Returns all errors, not just first\n","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T04:27:42.235649522-05:00","closed_at":"2026-01-07T04:27:42.235649522-05:00","close_reason":"Closed","labels":["templates","validation"],"dependencies":[{"issue_id":"meow-e2.3","depends_on_id":"meow-e2.1","type":"blocks","created_at":"2026-01-07T03:14:30.678684394-05:00","created_by":"ubuntu"}]}
{"id":"meow-e2.4","title":"Implement template baking (template → beads)","description":"Transform a parsed, validated template into executable beads.","notes":"## Baking Process\n1. Load template\n2. Validate\n3. Substitute variables\n4. Generate bead IDs for each step\n5. Translate needs from step IDs to bead IDs\n6. Create beads\n\n## ID Generation\nFormat: {workflow_id}.{step_id}-{hash}\nExample: meow-run-001.load-context-a3f8\n\n## Handling Nested Structures\n- expand steps create placeholder beads (runtime expansion)\n- inline steps in conditions get baked immediately\n\n## Acceptance Criteria\n- [ ] Simple template bakes to correct beads\n- [ ] Dependencies translate correctly\n- [ ] Inline steps become child beads\n- [ ] Bead IDs are unique and traceable\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T04:30:15.770845963-05:00","closed_at":"2026-01-07T04:30:15.770845963-05:00","close_reason":"Closed","labels":["baking","templates"],"dependencies":[{"issue_id":"meow-e2.4","depends_on_id":"meow-e2.2","type":"blocks","created_at":"2026-01-07T03:14:30.78982717-05:00","created_by":"ubuntu"},{"issue_id":"meow-e2.4","depends_on_id":"meow-e2.3","type":"blocks","created_at":"2026-01-07T03:14:30.882377165-05:00","created_by":"ubuntu"}]}
{"id":"meow-e2.5","title":"Implement template loading from filesystem and embedded","description":"Load templates from multiple sources with precedence.","notes":"## Load Order\n1. Project: .meow/templates/{name}.toml\n2. User: ~/.config/meow/templates/{name}.toml\n3. Embedded: Built into binary\n\n## Embedded Templates\nUse Go embed directive:\n```go\n//go:embed templates/*.toml\nvar embeddedTemplates embed.FS\n```\n\n## Acceptance Criteria\n- [ ] Embedded templates load correctly\n- [ ] Project templates override embedded\n- [ ] Helpful error when template not found\n","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T05:09:11.349713229-05:00","closed_at":"2026-01-07T05:09:11.349713229-05:00","close_reason":"Template loading implemented: Loader with priority (project \u003e user \u003e embedded), Load() search with TemplateNotFoundError, List() for all available templates, support for embed.FS, comprehensive test coverage","labels":["loading","templates"],"dependencies":[{"issue_id":"meow-e2.5","depends_on_id":"meow-e2.1","type":"blocks","created_at":"2026-01-07T03:14:30.970749274-05:00","created_by":"ubuntu"}]}
{"id":"meow-e3","title":"Orchestrator Core: Main loop and state management","description":"The heart of MEOW. Main loop, bead readiness detection, state management,\nand recovery.\n","notes":"## Design Philosophy\n\u003e \"The orchestrator is dumb; the templates are smart.\"\n\nThe orchestrator knows ONLY the 6 primitives. Everything else—loops,\ngates, refresh, checkpoint/resume—is template composition.\n\n## Success Criteria\n- Main loop runs continuously\n- Correctly identifies ready beads\n- Dispatches to appropriate handlers (6 types)\n- Captures and stores outputs from code beads\n- Validates and stores outputs from task beads\n- Persists state for recovery\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.457391798-05:00","updated_at":"2026-01-07T05:12:35.781453383-05:00","closed_at":"2026-01-07T05:12:35.781453383-05:00","close_reason":"Orchestrator core complete: main loop, bead readiness (BeadStore.GetNextReady), dispatch to all 6 handlers (task/condition/stop/start/code/expand), state persistence (StatePersister), crash recovery (StartOrResume), execution tracing. Tests pass.","labels":["epic","orchestrator","phase-1"],"dependencies":[{"issue_id":"meow-e3","depends_on_id":"meow-e1","type":"blocks","created_at":"2026-01-07T03:14:31.059165616-05:00","created_by":"ubuntu"},{"issue_id":"meow-e3","depends_on_id":"meow-e2","type":"blocks","created_at":"2026-01-07T03:14:31.149251566-05:00","created_by":"ubuntu"}]}
{"id":"meow-e3.1","title":"Implement orchestrator main loop","description":"Implement the core orchestrator loop.","notes":"## Loop Structure\n```go\nfor {\n    bead := getNextReadyBead()\n    if bead == nil {\n        if allDone() { return nil }\n        sleep and continue\n    }\n    dispatch(bead)\n    updateHeartbeat()\n}\n```\n\n## Dispatch by Type (6 primitives)\n```go\nswitch bead.Type {\ncase \"task\":      waitForClaudeToClose(bead)\ncase \"condition\": evalAndExpand(bead)  // may block!\ncase \"stop\":      killAgent(bead)\ncase \"start\":     spawnAgent(bead)  // handles resume_session\ncase \"code\":      execShell(bead)   // captures outputs\ncase \"expand\":    expandTemplate(bead)\n}\n```\n\n## Concurrency\nConditions run in goroutines to avoid blocking main loop.\n\n## Acceptance Criteria\n- [ ] Loop runs until no ready beads\n- [ ] Dispatches correctly to all 6 handlers\n- [ ] Conditions don't block main loop\n- [ ] Graceful shutdown on context cancel\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:30:08.194657253-05:00","closed_at":"2026-01-07T03:30:08.194657253-05:00","close_reason":"Orchestrator main loop with dispatch to all 6 primitives, condition concurrency, graceful shutdown","labels":["main-loop","orchestrator"],"dependencies":[{"issue_id":"meow-e3.1","depends_on_id":"meow-e1.2","type":"blocks","created_at":"2026-01-07T03:14:31.236169907-05:00","created_by":"ubuntu"}]}
{"id":"meow-e3.2","title":"Implement bead readiness detection","description":"Determine which beads are ready for execution.","notes":"## Readiness Rules\nA bead is ready when:\n1. Status is `open`\n2. All beads in `needs` are `closed`\n3. Not already being processed\n\n## Priority Ordering\n1. Orchestrator beads first (condition, expand, code, stop, etc.)\n2. Then task beads\n3. Within type: earlier creation time\n\n## Change Detection\nWatch .beads/issues.jsonl for changes rather than polling.\n\n## Acceptance Criteria\n- [ ] Correctly identifies ready beads\n- [ ] Dependencies checked correctly\n- [ ] Priority ordering correct\n- [ ] File watching triggers re-check\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:32:27.47575877-05:00","closed_at":"2026-01-07T03:32:27.47575877-05:00","close_reason":"FileBeadStore with readiness detection, dependency checking, priority ordering","labels":["orchestrator","readiness"],"dependencies":[{"issue_id":"meow-e3.2","depends_on_id":"meow-e3.1","type":"blocks","created_at":"2026-01-07T03:14:31.32470772-05:00","created_by":"ubuntu"}]}
{"id":"meow-e3.3","title":"Implement orchestrator state persistence","description":"Persist orchestrator state for crash recovery.","notes":"## State Files\n- .meow/state/orchestrator.json - workflow state\n- .meow/agents.json - agent states\n- .meow/state/heartbeat.json - health check\n- .meow/state/orchestrator.lock - prevent concurrent\n\n## Atomic Writes\nWrite to temp file, then rename.\n\n## Lock File\nPrevent concurrent orchestrators via exclusive lock.\n\n## Acceptance Criteria\n- [ ] State persists across iterations\n- [ ] Atomic writes prevent corruption\n- [ ] Lock prevents concurrent instances\n- [ ] Stale lock detection works\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:33:59.374313708-05:00","closed_at":"2026-01-07T03:33:59.374313708-05:00","close_reason":"StatePersister with atomic writes, lock file, heartbeat, and crash detection","labels":["orchestrator","state"],"dependencies":[{"issue_id":"meow-e3.3","depends_on_id":"meow-e3.1","type":"blocks","created_at":"2026-01-07T03:14:31.416863508-05:00","created_by":"ubuntu"}]}
{"id":"meow-e3.4","title":"Implement orchestrator startup and crash recovery","description":"Handle orchestrator startup, including recovery from crashes.","notes":"## Startup Flow\n1. Acquire lock\n2. Check for existing state\n3. If exists: resume flow\n4. If not: fresh start flow\n\n## Recovery Flow\n1. Load orchestrator state\n2. Load agent states\n3. Reconcile with reality (check tmux sessions)\n4. Reset in-progress beads from dead agents\n5. Resume main loop\n\n## Acceptance Criteria\n- [ ] Fresh start creates beads and spawns agent\n- [ ] Resume loads existing state\n- [ ] Dead agents detected via tmux\n- [ ] In-progress beads from dead agents reset\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T04:53:57.888201817-05:00","closed_at":"2026-01-07T04:53:57.888201817-05:00","close_reason":"Implemented orchestrator startup and crash recovery with StartOrResume method, lock acquisition, fresh start flow, resume flow, and crash recovery (detects dead agents, resets orphaned beads). Added 7 comprehensive tests.","labels":["orchestrator","recovery"],"dependencies":[{"issue_id":"meow-e3.4","depends_on_id":"meow-e3.3","type":"blocks","created_at":"2026-01-07T03:14:31.504407164-05:00","created_by":"ubuntu"}]}
{"id":"meow-e3.5","title":"Implement execution trace logging","description":"Log all orchestrator actions for debugging and audit.","notes":"## Trace Format\nJSONL in .meow/state/trace.jsonl\nEach entry: timestamp, action, details\n\n## Actions to Log\n- start, bake, spawn, dispatch, condition_eval, expand, close\n\n## CLI Access\n`meow trace [--follow] [--json] [--since 1h]`\n\n## Acceptance Criteria\n- [ ] All dispatch actions logged\n- [ ] Trace survives crash\n- [ ] meow trace command works\n","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T05:11:51.573905298-05:00","closed_at":"2026-01-07T05:11:51.573905298-05:00","close_reason":"Execution trace logging implemented: Tracer with JSONL output, all action types (start/resume/bake/spawn/dispatch/condition_eval/expand/close/stop/shutdown/error), NullTracer for testing, comprehensive test coverage","labels":["logging","orchestrator"],"dependencies":[{"issue_id":"meow-e3.5","depends_on_id":"meow-e3.1","type":"blocks","created_at":"2026-01-07T03:14:31.594932116-05:00","created_by":"ubuntu"}]}
{"id":"meow-e3.6","title":"Implement graceful orchestrator shutdown","description":"Handle SIGTERM/SIGINT gracefully to prevent state corruption.","notes":"## Why This Task\nOrchestrator can be killed (Ctrl+C, systemd stop, etc.). Without graceful\nshutdown, we risk:\n- Corrupted state files (mid-write)\n- Orphaned tmux sessions\n- In-progress beads stuck forever\n\n## Shutdown Flow\n1. Receive SIGTERM or SIGINT\n2. Cancel main loop context\n3. Save orchestrator state immediately\n4. For each active agent:\n   - Send graceful stop (Ctrl+C to tmux)\n   - Wait up to grace_period (configurable, default 10s)\n   - Force kill if still running\n5. Update agent states to \"stopped\"\n6. Release lock file\n7. Exit cleanly\n\n## Implementation\n```go\nfunc (o *Orchestrator) setupSignalHandling(ctx context.Context) context.Context {\n    ctx, cancel := context.WithCancel(ctx)\n\n    sigChan := make(chan os.Signal, 1)\n    signal.Notify(sigChan, syscall.SIGTERM, syscall.SIGINT)\n\n    go func() {\n        sig := \u003c-sigChan\n        o.logger.Info(\"Received signal, shutting down gracefully\",\n            \"signal\", sig)\n\n        // Save state first\n        if err := o.saveState(); err != nil {\n            o.logger.Error(\"Failed to save state during shutdown\", \"error\", err)\n        }\n\n        // Stop all agents\n        for _, agent := range o.agentStore.ListByStatus(AgentActive) {\n            o.stopAgentGracefully(agent, o.cfg.StopGracePeriod)\n        }\n\n        // Release lock\n        o.lock.Release()\n\n        cancel()\n    }()\n\n    return ctx\n}\n```\n\n## Config\n```toml\n[orchestrator]\nstop_grace_period = 10  # seconds to wait for agent cleanup\n```\n\n## Acceptance Criteria\n- [ ] SIGTERM triggers graceful shutdown\n- [ ] SIGINT (Ctrl+C) triggers graceful shutdown\n- [ ] State is saved before agent cleanup\n- [ ] Active agents receive stop signal\n- [ ] Lock file is released\n- [ ] Exit code is 0 for clean shutdown\n- [ ] Integration test: kill -TERM during execution\n","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["orchestrator","reliability","shutdown"],"dependencies":[{"issue_id":"meow-e3.6","depends_on_id":"meow-e3.4","type":"blocks","created_at":"2026-01-07T03:14:31.684651471-05:00","created_by":"ubuntu"},{"issue_id":"meow-e3.6","depends_on_id":"meow-e5.3","type":"blocks","created_at":"2026-01-07T03:14:31.770870614-05:00","created_by":"ubuntu"}]}
{"id":"meow-e4","title":"Primitive Handlers: All 6 primitive implementations","description":"Implement the handlers for all 6 primitive bead types.\n","notes":"## The 6 Primitives\n1. task - Wait for Claude to close (with output validation)\n2. condition - Evaluate shell, expand on_true/on_false\n3. stop - Kill tmux session\n4. start - Spawn tmux session (with optional resume_session)\n5. code - Execute shell script (with output capture)\n6. expand - Load and bake template (with ephemeral support)\n\n## Why 6 Instead of 8?\ncheckpoint and resume are now composed from code + start:\n- checkpoint → code bead with `meow session-id`\n- resume → start bead with `resume_session` parameter\n\n## Success Criteria\n- All 6 primitives have working handlers\n- Code beads capture and store outputs\n- Task beads validate required outputs\n- Start beads handle resume_session\n- Handlers are isolated and testable\n- Error handling is consistent\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.457391798-05:00","updated_at":"2026-01-07T05:28:31.737025067-05:00","closed_at":"2026-01-07T05:28:31.737025067-05:00","close_reason":"All 6 primitive handlers completed with retry logic, timeout handling, ephemeral cleanup, and tmux agent manager","labels":["epic","phase-2","primitives"],"dependencies":[{"issue_id":"meow-e4","depends_on_id":"meow-e3","type":"blocks","created_at":"2026-01-07T03:14:31.85942527-05:00","created_by":"ubuntu"}]}
{"id":"meow-e4.1","title":"Implement task primitive handler","description":"Handle task beads by waiting for Claude to close them with validated outputs.","notes":"## Behavior\n1. Verify assigned agent is running\n2. Mark bead in_progress\n3. Wait for bead status to become closed\n4. **Validate outputs if task has required outputs**\n5. Store validated outputs on bead\n6. Return (main loop finds next bead)\n\n## Task Outputs\nTasks can declare required/optional outputs:\n```yaml\noutputs:\n  required:\n    - name: \"work_bead\"\n      type: \"bead_id\"\n  optional:\n    - name: \"notes\"\n      type: \"string\"\n```\n\nClaude closes with: `meow close \u003cbead\u003e --output work_bead=bd-123`\n\n## Output Types\n- string, string[], number, boolean, json\n- bead_id (validated against .beads/)\n- file_path (validated file exists)\n\n## Agent runs `meow close` when done\n\n## Acceptance Criteria\n- [ ] Waits for agent to close bead\n- [ ] Marks bead in_progress\n- [ ] **Validates required outputs before accepting close**\n- [ ] **Stores outputs on bead for subsequent references**\n- [ ] Returns validation errors if outputs missing/invalid\n- [ ] Returns when bead is closed with valid outputs\n- [ ] Handles agent death gracefully\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T05:28:26.533955496-05:00","closed_at":"2026-01-07T05:28:26.533955496-05:00","close_reason":"Implemented all primitive handlers with retry, timeout, ephemeral cleanup, and tmux agent manager","labels":["primitives","task"],"dependencies":[{"issue_id":"meow-e4.1","depends_on_id":"meow-e3.2","type":"blocks","created_at":"2026-01-07T03:14:31.947185006-05:00","created_by":"ubuntu"}]}
{"id":"meow-e4.2","title":"Implement condition primitive handler","description":"Handle condition beads by evaluating shell and expanding results.","notes":"## Behavior\n1. Mark in_progress\n2. Execute shell command (in goroutine - may block!)\n3. Based on exit code, expand on_true or on_false\n4. Close bead\n\n## Key Insight\nConditions can block indefinitely - human gates, CI waits, etc.\n\n## Acceptance Criteria\n- [ ] Shell command executes\n- [ ] Exit 0 → on_true\n- [ ] Exit ≠0 → on_false\n- [ ] Timeout → on_timeout\n- [ ] Bead auto-closes\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T05:28:26.541679877-05:00","closed_at":"2026-01-07T05:28:26.541679877-05:00","close_reason":"Implemented all primitive handlers with retry, timeout, ephemeral cleanup, and tmux agent manager","labels":["condition","primitives"],"dependencies":[{"issue_id":"meow-e4.2","depends_on_id":"meow-e3.2","type":"blocks","created_at":"2026-01-07T03:14:32.037137586-05:00","created_by":"ubuntu"}]}
{"id":"meow-e4.3","title":"Implement code primitive handler","description":"Handle code beads by executing shell scripts with output capture.","notes":"## Behavior\n1. Execute code in shell\n2. Capture stdout/stderr\n3. **If outputs defined: capture specified outputs**\n4. **Store outputs on bead for subsequent references**\n5. Handle errors based on on_error policy\n6. Close bead\n\n## Output Capture\n```yaml\noutputs:\n  path: stdout           # Capture stdout\n  error_log: stderr      # Capture stderr\n  sha: file:/tmp/sha.txt # Read from file\n  result: exit_code      # Exit code as string\n```\n\nOutputs become available as {{bead_id.outputs.field}}\n\n## Example: Worktree creation\n```yaml\ntype: code\ncode: |\n  git worktree add -b meow/worker ~/worktrees/worker HEAD\n  echo \"~/worktrees/worker\"\noutputs:\n  path: stdout\n```\n\nNext bead uses: `workdir = \"{{create-worktree.outputs.path}}\"`\n\n## on_error Options\n- continue: log and continue\n- abort: stop workflow\n- retry: retry up to max_retries\n\n## Acceptance Criteria\n- [ ] Shell script executes\n- [ ] Working directory set correctly\n- [ ] Environment variables passed\n- [ ] **stdout captured when outputs.X = stdout**\n- [ ] **File contents captured when outputs.X = file:/path**\n- [ ] **Outputs stored on bead for reference**\n- [ ] on_error policies work\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T05:28:26.543260019-05:00","closed_at":"2026-01-07T05:28:26.543260019-05:00","close_reason":"Implemented all primitive handlers with retry, timeout, ephemeral cleanup, and tmux agent manager","labels":["code","primitives"],"dependencies":[{"issue_id":"meow-e4.3","depends_on_id":"meow-e3.2","type":"blocks","created_at":"2026-01-07T03:14:32.129174786-05:00","created_by":"ubuntu"}]}
{"id":"meow-e4.4","title":"Implement expand primitive handler","description":"Handle expand beads by loading and baking templates with ephemeral support.","notes":"## Behavior\n1. Load referenced template\n2. Merge variables (including output references)\n3. Bake template into child beads\n4. **If ephemeral: true, label beads with meow:ephemeral**\n5. Wire dependencies\n6. Set assignee on children\n7. Close expand bead\n\n## Ephemeral Beads\nWhen `ephemeral: true` on expand or in template meta:\n- Child beads get `labels: [\"meow:ephemeral\"]`\n- They execute normally\n- After completion, can be auto-cleaned\n- Hidden in `bd list` by default\n\n## Example\n```yaml\ntype: expand\ntemplate: \"call-implement\"\nephemeral: true  # Machinery beads, not work beads\nvariables:\n  work_bead: \"{{select-task.outputs.work_bead}}\"\n```\n\n## Recursive Expansion\nChild expand beads get processed in later iterations.\n\n## Acceptance Criteria\n- [ ] Template loads correctly\n- [ ] Variables merge correctly (including output refs)\n- [ ] Child beads created\n- [ ] **Ephemeral flag propagates to labels**\n- [ ] Recursive expansion works\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T05:28:26.544767463-05:00","closed_at":"2026-01-07T05:28:26.544767463-05:00","close_reason":"Implemented all primitive handlers with retry, timeout, ephemeral cleanup, and tmux agent manager","labels":["expand","primitives"],"dependencies":[{"issue_id":"meow-e4.4","depends_on_id":"meow-e2.4","type":"blocks","created_at":"2026-01-07T03:14:32.218015448-05:00","created_by":"ubuntu"},{"issue_id":"meow-e4.4","depends_on_id":"meow-e3.2","type":"blocks","created_at":"2026-01-07T03:14:32.307659156-05:00","created_by":"ubuntu"}]}
{"id":"meow-e4.5","title":"Implement stop primitive handler","description":"Handle stop beads by killing agent tmux sessions.","notes":"## Behavior\n1. If graceful: send interrupt, wait, then force kill\n2. Kill tmux session\n3. Update agent state to stopped\n4. Close bead\n\n## Acceptance Criteria\n- [ ] Graceful stop sends interrupt first\n- [ ] Force kill after timeout\n- [ ] Agent state updated\n- [ ] Works if agent not running\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T05:28:26.546293648-05:00","closed_at":"2026-01-07T05:28:26.546293648-05:00","close_reason":"Implemented all primitive handlers with retry, timeout, ephemeral cleanup, and tmux agent manager","labels":["primitives","stop"],"dependencies":[{"issue_id":"meow-e4.5","depends_on_id":"meow-e5.1","type":"blocks","created_at":"2026-01-07T03:14:32.396395228-05:00","created_by":"ubuntu"}]}
{"id":"meow-e4.6","title":"Implement start primitive handler","description":"Handle start beads by spawning agents in tmux with optional resume.","notes":"## Behavior\n1. Create tmux session\n2. Set working directory (can be from prior bead output)\n3. Set environment\n4. **If resume_session: start Claude with --resume**\n5. Otherwise: start Claude fresh\n6. Wait for ready\n7. Inject meow prime\n8. Update agent state\n9. Close bead\n\n## Resume Support (replaces old resume primitive)\n```yaml\ntype: start\nagent: \"claude-1\"\nresume_session: \"{{save-session.outputs.session_id}}\"\nworkdir: \".\"\n```\n\nThis composes checkpoint/resume:\n- code bead saves session ID\n- start bead uses it to resume\n\n## Fresh Start\n```yaml\ntype: start\nagent: \"claude-2\"\nworkdir: \"{{setup-worktree.outputs.path}}\"\n```\n\n## Acceptance Criteria\n- [ ] Creates tmux session\n- [ ] Sets workdir (including from output references)\n- [ ] **Starts Claude with --resume when resume_session set**\n- [ ] Starts Claude fresh when no resume_session\n- [ ] Detects when ready\n- [ ] Injects meow prime\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T05:28:26.547932793-05:00","closed_at":"2026-01-07T05:28:26.547932793-05:00","close_reason":"Implemented all primitive handlers with retry, timeout, ephemeral cleanup, and tmux agent manager","labels":["primitives","start"],"dependencies":[{"issue_id":"meow-e4.6","depends_on_id":"meow-e5.1","type":"blocks","created_at":"2026-01-07T03:14:32.486939134-05:00","created_by":"ubuntu"}]}
{"id":"meow-e4.7","title":"Implement ephemeral bead cleanup","description":"Clean up ephemeral beads after template completion.","notes":"## Behavior\nWhen a template with ephemeral beads completes:\n1. Detect all beads with `meow:ephemeral` label\n2. Based on cleanup config, either:\n   - on_complete: auto-delete closed ephemeral beads\n   - manual: wait for `meow clean --ephemeral`\n   - never: keep for debugging\n\n## Why Ephemeral Beads?\nTemplate steps like \"load-context\", \"write-tests\" are operational\nmachinery, not work items. Cleaning them keeps bead history focused\non actual deliverables.\n\n## Config\n```toml\n[cleanup]\nephemeral = \"on_complete\"  # or \"manual\" or \"never\"\n```\n\n## Acceptance Criteria\n- [ ] Detects ephemeral beads by label\n- [ ] Respects cleanup config\n- [ ] Cleans only closed ephemeral beads\n- [ ] `meow clean --ephemeral` works for manual mode\n","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T05:28:26.549486684-05:00","closed_at":"2026-01-07T05:28:26.549486684-05:00","close_reason":"Implemented all primitive handlers with retry, timeout, ephemeral cleanup, and tmux agent manager","labels":["ephemeral","primitives"],"dependencies":[{"issue_id":"meow-e4.7","depends_on_id":"meow-e4.4","type":"blocks","created_at":"2026-01-07T03:14:32.575443146-05:00","created_by":"ubuntu"},{"issue_id":"meow-e4.7","depends_on_id":"meow-e1.5","type":"blocks","created_at":"2026-01-07T03:14:32.665093943-05:00","created_by":"ubuntu"}]}
{"id":"meow-e5","title":"Agent Management: tmux and lifecycle","description":"Manage agent lifecycle via tmux.","notes":"## Success Criteria\n- Can create/kill tmux sessions\n- Can send commands to sessions\n- Can detect if sessions are alive\n- Agent state reflects reality\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.457391798-05:00","updated_at":"2026-01-07T05:28:26.550970968-05:00","closed_at":"2026-01-07T05:28:26.550970968-05:00","close_reason":"Implemented all primitive handlers with retry, timeout, ephemeral cleanup, and tmux agent manager","labels":["agents","epic","phase-2"],"dependencies":[{"issue_id":"meow-e5","depends_on_id":"meow-e3","type":"blocks","created_at":"2026-01-07T03:14:32.754467801-05:00","created_by":"ubuntu"}]}
{"id":"meow-e5.0","title":"Validate tmux availability and version","description":"Check tmux is installed and meets version requirements at startup.","notes":"## Why This Task\nMEOW relies heavily on tmux for agent session management. If tmux is missing\nor too old, users will get confusing errors deep in execution.\n\n## Validation Rules\n- tmux must be in PATH\n- Version \u003e= 3.0 (required for -c workdir flag)\n- Provide clear, actionable error if validation fails\n\n## Implementation\n```go\nfunc ValidateTmux() error {\n    // Check existence\n    path, err := exec.LookPath(\"tmux\")\n    if err != nil {\n        return \u0026MeowError{\n            Code:    \"AGENT_003\",\n            Message: \"tmux not found in PATH\",\n            Details: map[string]any{\n                \"hint\": \"Install tmux: apt install tmux / brew install tmux\",\n            },\n        }\n    }\n\n    // Check version\n    out, _ := exec.Command(\"tmux\", \"-V\").Output()\n    version := parseTmuxVersion(string(out)) // e.g., \"tmux 3.3a\" -\u003e 3.3\n    if version \u003c 3.0 {\n        return \u0026MeowError{\n            Code:    \"AGENT_004\",\n            Message: fmt.Sprintf(\"tmux version %v too old (need \u003e= 3.0)\", version),\n            Details: map[string]any{\n                \"current\": version,\n                \"required\": 3.0,\n                \"hint\": \"Upgrade tmux to 3.0 or later\",\n            },\n        }\n    }\n\n    return nil\n}\n```\n\n## Call Site\nCalled at orchestrator startup, before any agent operations.\n\n## Acceptance Criteria\n- [ ] Detects missing tmux with helpful message\n- [ ] Detects old tmux version with upgrade instructions\n- [ ] Returns nil for valid tmux installation\n- [ ] Unit test with mock exec\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-08T01:05:13.992299528-05:00","closed_at":"2026-01-08T01:05:13.992299528-05:00","close_reason":"Implemented ValidateTmux() with AGENT_005/AGENT_006 error codes, version parsing, and comprehensive unit tests with mock exec","labels":["agents","prerequisite","validation"],"dependencies":[{"issue_id":"meow-e5.0","depends_on_id":"meow-e1.7","type":"blocks","created_at":"2026-01-07T03:14:32.843733014-05:00","created_by":"ubuntu"}]}
{"id":"meow-e5.1","title":"Implement tmux wrapper library","description":"Create a Go wrapper around tmux commands.","notes":"## Interface\n- NewSession, KillSession, SessionExists, ListSessions\n- SendKeys, SendKeysLiteral\n- CapturePane, SetEnv\n\n## Acceptance Criteria\n- [ ] Create session in directory\n- [ ] Kill session cleanly\n- [ ] Check if session exists\n- [ ] Send text to session\n- [ ] Capture pane output\n","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["agents","tmux"],"dependencies":[{"issue_id":"meow-e5.1","depends_on_id":"meow-e5.0","type":"blocks","created_at":"2026-01-07T03:14:32.933515295-05:00","created_by":"ubuntu"},{"issue_id":"meow-e5.1","depends_on_id":"meow-e1.2","type":"blocks","created_at":"2026-01-07T03:14:33.016869185-05:00","created_by":"ubuntu"}]}
{"id":"meow-e5.2","title":"Implement agent state storage","description":"Manage persistent agent state.","notes":"## Storage\n.meow/agents.json with agent records\n\n## Interface\nGet, Set, Update, Delete, List, ListByStatus\nLoad, Save\n\n## Acceptance Criteria\n- [ ] Persist agent state to disk\n- [ ] Atomic writes for safety\n- [ ] Thread-safe access\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-08T01:05:17.73908867-05:00","closed_at":"2026-01-08T01:05:17.73908867-05:00","close_reason":"Implemented AgentStore with Get/Set/Update/Delete/List/ListByStatus operations, atomic file writes to .meow/agents.json, and comprehensive unit tests","labels":["agents","state"],"dependencies":[{"issue_id":"meow-e5.2","depends_on_id":"meow-e1.2","type":"blocks","created_at":"2026-01-07T03:14:33.111754683-05:00","created_by":"ubuntu"}]}
{"id":"meow-e5.3","title":"Implement agent spawning logic","description":"Higher-level agent spawning that coordinates tmux and state.","notes":"## Spawn Flow\n1. Check if agent already exists\n2. Create tmux session\n3. Configure environment\n4. Start Claude\n5. Wait for ready\n6. Inject initial prompt\n7. Update agent state\n\n## Acceptance Criteria\n- [ ] Creates complete agent setup\n- [ ] Handles existing agent\n- [ ] Cleans up on failure\n- [ ] Updates state correctly\n","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["agents","spawn"],"dependencies":[{"issue_id":"meow-e5.3","depends_on_id":"meow-e5.1","type":"blocks","created_at":"2026-01-07T03:14:33.199682711-05:00","created_by":"ubuntu"},{"issue_id":"meow-e5.3","depends_on_id":"meow-e5.2","type":"blocks","created_at":"2026-01-07T03:14:33.290518593-05:00","created_by":"ubuntu"}]}
{"id":"meow-e5.4","title":"Implement agent health monitoring","description":"Monitor agent health and detect crashes/stuck agents.","notes":"## Health Checks\n- Session exists (tmux has-session)\n- Activity check (recent progress)\n- Stuck detection (same bead too long)\n\n## Acceptance Criteria\n- [ ] Detects crashed sessions\n- [ ] Detects stuck agents\n- [ ] Updates state on crash\n","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["agents","monitoring"],"dependencies":[{"issue_id":"meow-e5.4","depends_on_id":"meow-e5.3","type":"blocks","created_at":"2026-01-07T03:14:33.385427189-05:00","created_by":"ubuntu"}]}
{"id":"meow-e6","title":"Condition System: Blocking, timeouts, and gates","description":"Deep implementation of blocking conditions.","notes":"## Key Feature\nConditions can block indefinitely - this enables human gates, CI waits, etc.\n","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.457391798-05:00","updated_at":"2026-01-07T03:12:48.457391798-05:00","labels":["conditions","epic","phase-3"],"dependencies":[{"issue_id":"meow-e6","depends_on_id":"meow-e4","type":"blocks","created_at":"2026-01-07T03:14:33.482137985-05:00","created_by":"ubuntu"}]}
{"id":"meow-e6.1","title":"Implement blocking shell execution with cancellation","description":"Shell commands that block indefinitely with cancellation support.","notes":"Must support cancellation via context.\nRun in goroutines to not block main loop.\n","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T04:38:59.239318032-05:00","closed_at":"2026-01-07T04:38:59.239318032-05:00","close_reason":"Implemented ShellExecutor in internal/executor/shell.go with:\n- Context cancellation support (SIGTERM then SIGKILL)\n- Process group handling for killing child processes\n- Output capture: stdout, stderr, exit_code, file\n- Working directory and environment variable support\n- 16 passing unit tests","labels":["blocking","conditions"]}
{"id":"meow-e6.2","title":"Implement condition timeout handling","description":"Timeouts specified on conditions.","notes":"On timeout, expand on_timeout template (or on_false if not specified).\n","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["conditions","timeout"],"dependencies":[{"issue_id":"meow-e6.2","depends_on_id":"meow-e6.1","type":"blocks","created_at":"2026-01-07T03:14:33.569531385-05:00","created_by":"ubuntu"}]}
{"id":"meow-e6.3","title":"Implement helper commands (wait-approve, wait-file, etc.)","description":"Convenience commands for common blocking patterns.","notes":"Commands:\n- meow wait-approve --bead \u003cid\u003e\n- meow wait-file \u003cpath\u003e\n- meow wait-bead \u003cid\u003e --status closed\n- meow context-usage --threshold N --format exit-code\n","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["conditions","helpers"],"dependencies":[{"issue_id":"meow-e6.3","depends_on_id":"meow-e6.1","type":"blocks","created_at":"2026-01-07T03:14:33.662016544-05:00","created_by":"ubuntu"}]}
{"id":"meow-e6.4","title":"Implement gate approval flow","description":"Human approval unblocking via meow approve.","notes":"`meow approve \u003cbead\u003e` creates marker that `meow wait-approve` detects.\n","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["conditions","gates"],"dependencies":[{"issue_id":"meow-e6.4","depends_on_id":"meow-e6.1","type":"blocks","created_at":"2026-01-07T03:14:33.755085213-05:00","created_by":"ubuntu"}]}
{"id":"meow-e6.5","title":"Implement meow test-runner helper command","description":"Project-type-aware test runner for TDD workflow conditions.","notes":"## Why This Task\nThe implement-tdd template needs to run tests but different projects use\ndifferent test frameworks (npm test, go test, pytest, cargo test, etc.).\nHard-coding framework detection in templates is fragile.\n\n## Solution\n`meow test-runner` abstracts the test command based on project detection.\n\n## Usage\n```bash\nmeow test-runner                    # Run tests, exit 0 if pass\nmeow test-runner --expect-fail      # Exit 0 if tests FAIL (for TDD)\nmeow test-runner --framework npm    # Force specific framework\n```\n\n## Project Detection\n1. If `package.json` exists and has `scripts.test`: npm test\n2. If `go.mod` exists: go test ./...\n3. If `Cargo.toml` exists: cargo test\n4. If `pytest.ini` or `setup.py` exists: pytest\n5. If `Makefile` with `test` target: make test\n6. Fallback: error with helpful message\n\n## Implementation\n```go\nfunc (c *TestRunnerCmd) Run() error {\n    framework := c.detectFramework()\n    if framework == \"\" {\n        return \u0026MeowError{\n            Code:    \"TEST_001\",\n            Message: \"Could not detect test framework\",\n            Details: map[string]any{\n                \"hint\": \"Use --framework to specify manually\",\n                \"supported\": []string{\"npm\", \"go\", \"cargo\", \"pytest\", \"make\"},\n            },\n        }\n    }\n\n    cmd := c.buildCommand(framework)\n    exitCode := runCommand(cmd)\n\n    if c.expectFail {\n        // For TDD: success means tests failed as expected\n        if exitCode != 0 {\n            return nil  // Tests failed = success\n        }\n        return fmt.Errorf(\"tests passed unexpectedly\")\n    }\n\n    if exitCode != 0 {\n        return fmt.Errorf(\"tests failed with exit code %d\", exitCode)\n    }\n    return nil\n}\n```\n\n## Use in Templates\n```toml\n# In implement-tdd.toml\n[[steps]]\nid = \"verify-fail\"\ntype = \"condition\"\ncondition = \"meow test-runner --expect-fail\"  # Clean, project-agnostic\n```\n\n## Acceptance Criteria\n- [ ] Detects npm projects\n- [ ] Detects Go projects\n- [ ] Detects Cargo projects\n- [ ] --expect-fail inverts exit code\n- [ ] --framework overrides detection\n- [ ] Helpful error when detection fails\n- [ ] Unit tests for each detection path\n","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["conditions","helpers","testing"],"dependencies":[{"issue_id":"meow-e6.5","depends_on_id":"meow-e6.1","type":"blocks","created_at":"2026-01-07T03:14:33.842319108-05:00","created_by":"ubuntu"}]}
{"id":"meow-e7","title":"Output Binding \u0026 Session Management","description":"Implement output binding between beads and session management for\ncheckpoint/resume composition.\n","notes":"## Why This Epic\nOutput binding is the key capability that enables:\n- Dynamic worktree paths from code → start\n- Task selection outputs from Claude → orchestrator\n- Session IDs from code → start (for resume)\n\n## Key Components\n1. Output storage on beads\n2. Output reference resolution in variable substitution\n3. meow session-id command for checkpoint composition\n4. meow close --output for task outputs\n","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.457391798-05:00","updated_at":"2026-01-07T03:12:48.457391798-05:00","labels":["epic","outputs","phase-3","session"],"dependencies":[{"issue_id":"meow-e7","depends_on_id":"meow-e4","type":"blocks","created_at":"2026-01-07T03:14:33.933739685-05:00","created_by":"ubuntu"},{"issue_id":"meow-e7","depends_on_id":"meow-e5","type":"blocks","created_at":"2026-01-07T03:14:34.024222144-05:00","created_by":"ubuntu"}]}
{"id":"meow-e7.1","title":"Implement meow session-id command","description":"Command to discover and output Claude's session ID.","notes":"## Purpose\nThis command enables checkpoint composition:\n```yaml\ntype: code\ncode: meow session-id --agent {{agent}}\noutputs:\n  session_id: stdout\n```\n\nThe output can then be used by a start bead:\n```yaml\ntype: start\nresume_session: \"{{save-session.outputs.session_id}}\"\n```\n\n## Session ID Discovery\n- Read $MEOW_SESSION_ID if set (via meow prime --hook)\n- Or find latest in ~/.claude/sessions/ for agent\n- Or query tmux session for environment\n\n## Usage\n```bash\nmeow session-id              # Current agent\nmeow session-id --agent X    # Specific agent\nmeow session-id --save       # Also save to .meow/sessions/\n```\n\n## Acceptance Criteria\n- [ ] Discovers session ID from environment\n- [ ] Falls back to session file discovery\n- [ ] Outputs clean session ID to stdout\n- [ ] Works in code bead context\n","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["cli","session"],"dependencies":[{"issue_id":"meow-e7.1","depends_on_id":"meow-e5.2","type":"blocks","created_at":"2026-01-07T03:14:34.11118274-05:00","created_by":"ubuntu"}]}
{"id":"meow-e7.2","title":"Implement output storage on beads","description":"Store captured outputs on bead records.","notes":"## Storage Format\n```json\n{\n  \"id\": \"create-worktree\",\n  \"type\": \"code\",\n  \"status\": \"closed\",\n  \"outputs\": {\n    \"path\": \"~/worktrees/worker\",\n    \"sha\": \"abc123\"\n  }\n}\n```\n\n## Requirements\n- Outputs persist in bead file\n- Outputs queryable via bd show\n- Outputs survive orchestrator restart\n\n## Acceptance Criteria\n- [ ] Code beads store captured outputs\n- [ ] Task beads store validated outputs\n- [ ] Outputs visible in bd show\n- [ ] Outputs persist across restarts\n","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["outputs","storage"]}
{"id":"meow-e7.3","title":"Implement output reference resolution","description":"Resolve {{bead.outputs.field}} references during template processing.","notes":"## Resolution Process\nWhen processing a template with {{bead_id.outputs.field}}:\n1. Find bead with matching ID\n2. Check bead is closed (outputs available)\n3. Look up outputs.field\n4. Substitute value\n\n## Error Cases\n- Bead not found → error with available beads\n- Bead not closed → error (dependency issue)\n- Output field not found → error with available fields\n\n## Acceptance Criteria\n- [ ] Resolves valid output references\n- [ ] Clear error for missing bead\n- [ ] Clear error for unclosed bead\n- [ ] Clear error for missing field\n","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["outputs","resolution"],"dependencies":[{"issue_id":"meow-e7.3","depends_on_id":"meow-e7.2","type":"blocks","created_at":"2026-01-07T03:14:34.202956446-05:00","created_by":"ubuntu"},{"issue_id":"meow-e7.3","depends_on_id":"meow-e2.2","type":"blocks","created_at":"2026-01-07T03:14:34.293578702-05:00","created_by":"ubuntu"}]}
{"id":"meow-e7.4","title":"Implement output type validators","description":"Implement validators for all output types including bead_id.","notes":"## Why This Task is Critical\nOutput validation is what makes Claude's outputs reliable. Without proper\nvalidation, typos and hallucinated bead IDs would break workflows.\n\n## Output Types to Validate\n```go\ntype OutputType string\n\nconst (\n    TypeString    OutputType = \"string\"\n    TypeStringArr OutputType = \"string[]\"\n    TypeNumber    OutputType = \"number\"\n    TypeBoolean   OutputType = \"boolean\"\n    TypeJSON      OutputType = \"json\"\n    TypeBeadID    OutputType = \"bead_id\"\n    TypeBeadIDArr OutputType = \"bead_id[]\"\n    TypeFilePath  OutputType = \"file_path\"\n)\n```\n\n## Validator Interface\n```go\ntype OutputValidator interface {\n    Validate(value string, ctx ValidationContext) error\n    TypeName() string\n}\n\ntype ValidationContext struct {\n    BeadsDir    string\n    WorkDir     string\n    BeadLookup  func(id string) (*types.Bead, bool)\n}\n```\n\n## bead_id Validator (Most Important)\n```go\ntype BeadIDValidator struct{}\n\nfunc (v *BeadIDValidator) Validate(value string, ctx ValidationContext) error {\n    // Check format\n    if !strings.HasPrefix(value, \"bd-\") {\n        return fmt.Errorf(\"bead_id must start with 'bd-', got '%s'\", value)\n    }\n\n    // Check existence\n    bead, found := ctx.BeadLookup(value)\n    if !found {\n        // Suggest similar beads\n        suggestions := findSimilarBeads(value, ctx)\n        return \u0026BeadNotFoundError{\n            ID:          value,\n            Suggestions: suggestions,\n        }\n    }\n\n    return nil\n}\n```\n\n## file_path Validator\n```go\ntype FilePathValidator struct{}\n\nfunc (v *FilePathValidator) Validate(value string, ctx ValidationContext) error {\n    path := value\n    if !filepath.IsAbs(path) {\n        path = filepath.Join(ctx.WorkDir, path)\n    }\n\n    if _, err := os.Stat(path); os.IsNotExist(err) {\n        return fmt.Errorf(\"file does not exist: %s\", value)\n    }\n\n    return nil\n}\n```\n\n## Error Messages\nMust be helpful and actionable:\n```\nError: Output validation failed for 'work_bead'\n\n  Value: \"bd-task-999\"\n  Type: bead_id\n  Error: Bead 'bd-task-999' does not exist\n\n  Did you mean one of these?\n    • bd-task-001 \"Implement auth\"\n    • bd-task-002 \"Add validation\"\n    • bd-task-003 \"Write tests\"\n\nHint: Run 'bd list --status=open' to see available beads\n```\n\n## Acceptance Criteria\n- [ ] All 8 types have working validators\n- [ ] bead_id checks actual bead existence\n- [ ] file_path checks file existence\n- [ ] Suggestions provided for typos\n- [ ] Error messages are actionable\n- [ ] Unit tests for each validator\n","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["critical","outputs","validation"],"dependencies":[{"issue_id":"meow-e7.4","depends_on_id":"meow-e7.2","type":"blocks","created_at":"2026-01-07T03:14:34.382248765-05:00","created_by":"ubuntu"}]}
{"id":"meow-e8","title":"Integration: Beads, hooks, recovery","description":"Integration with external systems.","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.457391798-05:00","updated_at":"2026-01-07T03:12:48.457391798-05:00","labels":["epic","integration","phase-3"],"dependencies":[{"issue_id":"meow-e8","depends_on_id":"meow-e3","type":"blocks","created_at":"2026-01-07T03:14:34.469376424-05:00","created_by":"ubuntu"},{"issue_id":"meow-e8","depends_on_id":"meow-e4","type":"blocks","created_at":"2026-01-07T03:14:34.56063549-05:00","created_by":"ubuntu"}]}
{"id":"meow-e8.1","title":"Implement beads integration","description":"Implement MEOW's integration with the beads data layer.\n\n## Architecture Decision: Overlay Approach (No Fork)\n\nPer SPEC-ADDENDUM, MEOW **layers on top** of upstream beads rather than forking:\n- MEOW defines its own internal `Bead` type (`internal/types/bead.go`)\n- Both MEOW and upstream `bd` read/write the same `issues.jsonl` file\n- JSON schema flexibility means MEOW-specific fields are preserved but ignored by `bd`\n- ID prefix separation: `meow-*` for workflow beads, `bd-*` for work beads\n\n## Integration Approach: Direct File I/O\n\nMEOW reads/writes `.beads/issues.jsonl` directly using its internal types. We do NOT shell out to `bd` CLI for MEOW operations.\n\n```go\n// internal/orchestrator/beadstore.go already implements this!\ntype FileBeadStore struct {\n    path string  // .beads/issues.jsonl\n}\n\nfunc (s *FileBeadStore) Create(ctx context.Context, bead *types.Bead) error {\n    // Append bead as JSON line to issues.jsonl\n}\n\nfunc (s *FileBeadStore) Update(ctx context.Context, bead *types.Bead) error {\n    // Read all, update matching ID, write back\n}\n\nfunc (s *FileBeadStore) Get(ctx context.Context, id string) (*types.Bead, error) {\n    // Read file, find by ID\n}\n\nfunc (s *FileBeadStore) List(ctx context.Context, filter BeadFilter) ([]*types.Bead, error) {\n    // Read file, apply filter\n}\n```\n\n## ID Prefix Convention\n\n| Prefix | Source | Purpose |\n|--------|--------|---------|\n| `bd-*` | Created via `bd create` | Work beads (traditional issues) |\n| `meow-{workflow}.{step}` | Created by MEOW baker | Workflow beads (wisps, orchestrator) |\n\n## What This Task Actually Covers\n\nSince `FileBeadStore` is already implemented, this task is about:\n\n1. **Verifying compatibility** - Ensure MEOW-written beads are valid for upstream `bd`\n2. **ID generation** - Implement `meow-{workflow}.{step}` ID pattern\n3. **MEOW field serialization** - Verify `tier`, `hook_bead`, etc. serialize correctly\n4. **Concurrent access** - Handle case where both `meow` and `bd` modify the file\n\n## Test Cases\n\n```go\nfunc TestBeadsInterop(t *testing.T) {\n    // 1. Create bead with bd CLI\n    exec.Command(\"bd\", \"create\", \"--title\", \"Test work\").Run()\n    \n    // 2. Read it with MEOW's FileBeadStore\n    bead, _ := store.Get(ctx, \"bd-xxx\")\n    assert.Equal(t, \"Test work\", bead.Title)\n    \n    // 3. Create MEOW workflow bead\n    store.Create(ctx, \u0026types.Bead{\n        ID:   \"meow-abc.step-1\",\n        Tier: types.TierWisp,\n        // MEOW-specific fields\n    })\n    \n    // 4. Verify bd list shows it (but ignores MEOW fields)\n    out, _ := exec.Command(\"bd\", \"list\", \"--format\", \"json\").Output()\n    assert.Contains(t, string(out), \"meow-abc.step-1\")\n}\n```\n\n## Acceptance Criteria\n- [ ] FileBeadStore reads beads created by `bd` CLI\n- [ ] Beads created by MEOW are readable by `bd` CLI  \n- [ ] MEOW-specific fields are preserved through read/write cycles\n- [ ] ID prefix convention implemented in baker\n- [ ] Concurrent access doesn't corrupt data (file locking)","notes":"## Integration Points\nMEOW uses the `bd` CLI for all bead operations. This task integrates:\n\n### Bead Creation (template baking)\n```go\nfunc createBead(bead *types.Bead) error {\n    args := []string{\"create\",\n        \"--id\", bead.ID,\n        \"--type\", bead.Type,\n        \"--title\", bead.Title,\n    }\n    if bead.Parent != \"\" {\n        args = append(args, \"--parent\", bead.Parent)\n    }\n    for _, dep := range bead.Needs {\n        args = append(args, \"--dep\", dep)\n    }\n    return exec.Command(\"bd\", args...).Run()\n}\n```\n\n### Status Updates\n```go\nfunc updateBeadStatus(id string, status string) error {\n    return exec.Command(\"bd\", \"update\", id, \"--status\", status).Run()\n}\n```\n\n### Reading Beads\n```go\nfunc getBead(id string) (*types.Bead, error) {\n    out, err := exec.Command(\"bd\", \"show\", id, \"--format\", \"json\").Output()\n    if err != nil {\n        return nil, err\n    }\n    var bead types.Bead\n    json.Unmarshal(out, \u0026bead)\n    return \u0026bead, nil\n}\n```\n\n### Querying\n```go\nfunc listBeads(status string) ([]types.Bead, error) {\n    args := []string{\"list\", \"--format\", \"json\"}\n    if status != \"\" {\n        args = append(args, \"--status\", status)\n    }\n    // ...\n}\n```\n\n## Output Storage\nWhen storing outputs on beads:\n```go\nfunc storeOutputs(beadID string, outputs map[string]string) error {\n    outputJSON, _ := json.Marshal(outputs)\n    return exec.Command(\"bd\", \"update\", beadID,\n        \"--set\", fmt.Sprintf(\"outputs=%s\", outputJSON)).Run()\n}\n```\n\n## Acceptance Criteria\n- [ ] bd create integrates correctly\n- [ ] bd update for status changes\n- [ ] bd show for reading with JSON\n- [ ] bd list for queries\n- [ ] Output storage works\n- [ ] Error handling for bd failures\n","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T18:22:59.804970375-05:00","labels":["beads","integration"],"dependencies":[{"issue_id":"meow-e8.1","depends_on_id":"meow-e1.2","type":"blocks","created_at":"2026-01-07T03:14:34.649846479-05:00","created_by":"ubuntu"}]}
{"id":"meow-e8.2","title":"Implement Claude Code hooks setup","description":"Configure .claude/settings.json with MEOW hooks.","notes":"- SessionStart: meow prime --hook\n- Stop: meow prime --format prompt\n\nmeow init should set this up.\n","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["hooks","integration"]}
{"id":"meow-e8.3","title":"Test and validate crash recovery","description":"Integration test for crash recovery.","notes":"1. Start workflow\n2. Kill orchestrator mid-execution\n3. Restart\n4. Verify continues correctly\n","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["integration","recovery"],"dependencies":[{"issue_id":"meow-e8.3","depends_on_id":"meow-e3.4","type":"blocks","created_at":"2026-01-07T03:14:34.743798036-05:00","created_by":"ubuntu"}]}
{"id":"meow-e8.4","title":"Implement git worktree support","description":"Helper functions for git worktree operations in code beads.","notes":"## Why Worktrees Matter\nWorktrees allow child agents to work in isolated branches without\naffecting the parent's working directory. This enables:\n- Parallel work on different features\n- Clean separation of concerns\n- Easy cleanup after completion\n\n## Worktree Path Convention\n```\n.meow/worktrees/{agent-id}/\n```\n\n## Helper Functions\n```go\n// Create worktree for agent\nfunc CreateWorktree(agentID string, branch string) (string, error) {\n    path := filepath.Join(\".meow/worktrees\", agentID)\n    branchName := fmt.Sprintf(\"meow/%s\", agentID)\n\n    cmd := exec.Command(\"git\", \"worktree\", \"add\",\n        \"-b\", branchName,\n        path,\n        \"HEAD\")\n\n    if err := cmd.Run(); err != nil {\n        return \"\", fmt.Errorf(\"failed to create worktree: %w\", err)\n    }\n\n    return path, nil\n}\n\n// Remove worktree and branch\nfunc RemoveWorktree(agentID string) error {\n    path := filepath.Join(\".meow/worktrees\", agentID)\n    branchName := fmt.Sprintf(\"meow/%s\", agentID)\n\n    // Remove worktree\n    exec.Command(\"git\", \"worktree\", \"remove\", path).Run()\n\n    // Delete branch (force if needed)\n    exec.Command(\"git\", \"branch\", \"-D\", branchName).Run()\n\n    return nil\n}\n\n// Check if worktree exists\nfunc WorktreeExists(agentID string) bool {\n    path := filepath.Join(\".meow/worktrees\", agentID)\n    _, err := os.Stat(path)\n    return err == nil\n}\n```\n\n## Usage in call Template\nThe call template uses worktrees when `use_worktree = true`:\n```toml\n[[steps]]\nid = \"setup-worktree\"\ntype = \"code\"\ncode = '''\nmeow worktree create {{child}}\n'''\noutputs = { workdir = \"stdout\" }\n```\n\n## CLI Commands (optional)\n```bash\nmeow worktree create \u003cagent\u003e   # Create and output path\nmeow worktree remove \u003cagent\u003e   # Remove worktree and branch\nmeow worktree list             # List active worktrees\n```\n\n## Acceptance Criteria\n- [ ] Create worktree at .meow/worktrees/{agent}/\n- [ ] Remove worktree and cleanup branch\n- [ ] Handle existing worktree gracefully\n- [ ] Output path to stdout for capture\n- [ ] Unit tests with mock git\n","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["git","integration"]}
{"id":"meow-e9","title":"Default Templates: MVP template library","description":"Ship useful default templates.","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T03:12:48.457391798-05:00","updated_at":"2026-01-07T03:12:48.457391798-05:00","labels":["epic","phase-4","templates"],"dependencies":[{"issue_id":"meow-e9","depends_on_id":"meow-e2","type":"blocks","created_at":"2026-01-07T03:14:34.834779324-05:00","created_by":"ubuntu"}]}
{"id":"meow-e9.1","title":"Create work-loop template","description":"Main orchestration loop template.","notes":"Check for work → select → implement → check context → loop.\n","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["templates","work-loop"]}
{"id":"meow-e9.3","title":"Create human-gate template","description":"Blocking approval template.","notes":"prepare-summary → notify → await-approval → record-decision\n","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["gate","templates"]}
{"id":"meow-e9.4","title":"Create refresh and handoff templates","description":"Context refresh templates.","notes":"refresh: stop → start\nhandoff: write-notes → stop → start\n","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["refresh","templates"]}
{"id":"meow-e9.5","title":"Create context-check template","description":"Check context and maybe refresh.","notes":"## Template: context-check.toml\n```toml\n[meta]\nname = \"context-check\"\ndescription = \"Check context usage and trigger refresh if needed\"\n\n[variables]\nagent = { required = true }\nthreshold = { default = 70, description = \"Context % threshold\" }\n\n[[steps]]\nid = \"check\"\ntype = \"condition\"\ncondition = \"meow context-usage --agent {{agent}} --threshold {{threshold}} --format exit-code\"\non_true:\n  template = \"handoff\"\n  variables = { agent = \"{{agent}}\" }\non_false:\n  inline = []  # Continue without refresh\n```\n\n## Acceptance Criteria\n- [ ] Template parses and validates\n- [ ] Threshold is configurable\n- [ ] Triggers handoff when context high\n- [ ] Unit test for template validation\n","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["context","templates"]}
{"id":"meow-e9.6","title":"Create call template (parent/child orchestration)","description":"Template for spawning child agent, running workflow, resuming parent.","notes":"## Why This Template is Critical\nThe `call` template is the foundation for parent/child agent orchestration.\nIt demonstrates the composed checkpoint/resume pattern using the 6 primitives.\n\n## Template: call.toml\n```toml\n[meta]\nname = \"call\"\ndescription = \"Spawn child agent for sub-workflow, then resume parent\"\nephemeral = true  # All steps are operational machinery\n\n[variables]\nparent = { required = true, description = \"Parent agent ID\" }\nchild = { required = true, description = \"Child agent ID\" }\ntemplate = { required = true, description = \"Template for child to execute\" }\ntemplate_vars = { default = {}, description = \"Variables for child template\" }\nuse_worktree = { default = false, description = \"Create git worktree for child\" }\n\n# --- Save parent session ---\n[[steps]]\nid = \"save-parent-session\"\ntype = \"code\"\ncode = \"meow session-id --agent {{parent}}\"\noutputs = { session_id = \"stdout\" }\n\n[[steps]]\nid = \"stop-parent\"\ntype = \"stop\"\nagent = \"{{parent}}\"\nneeds = [\"save-parent-session\"]\n\n# --- Setup child workspace ---\n[[steps]]\nid = \"setup-worktree\"\ntype = \"code\"\nneeds = [\"stop-parent\"]\ncode = '''\nif [ \"{{use_worktree}}\" = \"true\" ]; then\n    git worktree add -b meow/{{child}} .meow/worktrees/{{child}} HEAD\n    echo \".meow/worktrees/{{child}}\"\nelse\n    pwd\nfi\n'''\noutputs = { workdir = \"stdout\" }\n\n# --- Start child ---\n[[steps]]\nid = \"start-child\"\ntype = \"start\"\nagent = \"{{child}}\"\nworkdir = \"{{setup-worktree.outputs.workdir}}\"\nneeds = [\"setup-worktree\"]\n\n# --- Child executes the work ---\n[[steps]]\nid = \"child-work\"\ntype = \"expand\"\ntemplate = \"{{template}}\"\nvariables = \"{{template_vars}}\"\nassignee = \"{{child}}\"\nneeds = [\"start-child\"]\n\n# --- Stop child ---\n[[steps]]\nid = \"stop-child\"\ntype = \"stop\"\nagent = \"{{child}}\"\nneeds = [\"child-work\"]\n\n# --- Cleanup worktree ---\n[[steps]]\nid = \"cleanup-worktree\"\ntype = \"code\"\nneeds = [\"stop-child\"]\ncode = '''\nif [ \"{{use_worktree}}\" = \"true\" ]; then\n    git worktree remove .meow/worktrees/{{child}} || true\n    git branch -d meow/{{child}} || true\nfi\n'''\n\n# --- Resume parent ---\n[[steps]]\nid = \"resume-parent\"\ntype = \"start\"\nagent = \"{{parent}}\"\nworkdir = \".\"\nresume_session = \"{{save-parent-session.outputs.session_id}}\"\nneeds = [\"cleanup-worktree\"]\n```\n\n## Key Features Demonstrated\n1. Output binding: session_id and workdir captured and used\n2. Composed checkpoint/resume: code → start with resume_session\n3. Ephemeral: all steps are machinery, not work\n4. Worktree isolation: optional per-agent workspace\n\n## Acceptance Criteria\n- [ ] Template parses and validates\n- [ ] Variables substitute correctly\n- [ ] Output references resolve\n- [ ] E2E test with mock agents\n- [ ] Unit test for template validation\n","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["call","critical","templates"],"dependencies":[{"issue_id":"meow-e9.6","depends_on_id":"meow-e7.1","type":"blocks","created_at":"2026-01-07T03:14:34.927608572-05:00","created_by":"ubuntu"},{"issue_id":"meow-e9.6","depends_on_id":"meow-e7.2","type":"blocks","created_at":"2026-01-07T03:14:35.018756942-05:00","created_by":"ubuntu"},{"issue_id":"meow-e9.6","depends_on_id":"meow-e7.3","type":"blocks","created_at":"2026-01-07T03:14:35.109804641-05:00","created_by":"ubuntu"}]}
{"id":"meow-e9.7","title":"Create implement-tdd template","description":"TDD workflow template that works with a work bead.","notes":"## Template: implement-tdd.toml\n```toml\n[meta]\nname = \"implement-tdd\"\ndescription = \"TDD implementation workflow\"\nephemeral = true  # Steps are operational\n\n[variables]\nwork_bead = { required = true, type = \"bead_id\", description = \"The work bead to implement\" }\n\n[[steps]]\nid = \"load-context\"\ntype = \"task\"\ntitle = \"Load context for {{work_bead}}\"\ndescription = |\n  1. Run: bd show {{work_bead}}\n  2. Understand the requirements\n  3. Identify relevant files\n  4. Update notes with your understanding\n\n[[steps]]\nid = \"write-tests\"\ntype = \"task\"\ntitle = \"Write failing tests\"\ndescription = \"Write tests that will fail until implementation is complete\"\nneeds = [\"load-context\"]\n\n[[steps]]\nid = \"verify-fail\"\ntype = \"condition\"\ncondition = \"meow test-runner --expect-fail\"  # Project-type agnostic\nneeds = [\"write-tests\"]\non_true:\n  inline = []  # Tests fail as expected, continue\non_false:\n  inline = [\n    { id = \"fix-tests\", type = \"task\", title = \"Tests passed unexpectedly - revise tests\" }\n  ]\n\n[[steps]]\nid = \"implement\"\ntype = \"task\"\ntitle = \"Write implementation\"\ndescription = \"Write the minimum code to make tests pass\"\nneeds = [\"verify-fail\"]\n\n[[steps]]\nid = \"verify-pass\"\ntype = \"condition\"\ncondition = \"meow test-runner\"  # Project-type agnostic\nneeds = [\"implement\"]\non_true:\n  inline = []  # Tests pass, continue\non_false:\n  inline = [\n    { id = \"fix-impl\", type = \"task\", title = \"Tests still failing - fix implementation\" }\n  ]\n\n[[steps]]\nid = \"commit\"\ntype = \"task\"\ntitle = \"Commit changes\"\ndescription = \"Create a descriptive commit for the changes\"\nneeds = [\"verify-pass\"]\n\n[[steps]]\nid = \"close-work-bead\"\ntype = \"code\"\ncode = \"bd close {{work_bead}} --notes 'Implemented via implement-tdd template'\"\nneeds = [\"commit\"]\n```\n\n## Acceptance Criteria\n- [ ] Template parses and validates\n- [ ] work_bead variable is type-checked as bead_id\n- [ ] Verify-fail/verify-pass conditions work\n- [ ] Work bead is closed at end\n- [ ] Unit test for template validation\n","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T03:12:48.465692926-05:00","updated_at":"2026-01-07T03:12:48.465692926-05:00","labels":["implement","tdd","templates"]}
{"id":"meow-fxw","title":"Implement tier partitioning logic","description":"Classify steps into Work/Wisp/Orchestrator tiers. See IMPLEMENTATION-PLAN section meow-modules-baker-partition.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T16:39:05.796809646-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:16:39.772075975-05:00","closed_at":"2026-01-07T18:16:39.772075975-05:00","close_reason":"Consolidated into meow-cxt (tier assignment in baker). Partitioning logic is part of determineTier() which goes in cxt.","dependencies":[{"issue_id":"meow-fxw","depends_on_id":"meow-ks2","type":"blocks","created_at":"2026-01-07T16:39:47.15279137-05:00","created_by":"ubuntu"}]}
{"id":"meow-gy2","title":"Baker: Wisp Detection and Tier Labeling","description":"Extend baker for automatic tier classification and wisp detection. Phase 2.","status":"open","priority":0,"issue_type":"epic","created_at":"2026-01-07T16:38:25.839652883-05:00","created_by":"ubuntu","updated_at":"2026-01-07T16:38:25.839652883-05:00"}
{"id":"meow-j5e","title":"Loader: Reference Resolution","description":"Extend template loader for module references (.local, file#workflow). Phase 2.","status":"open","priority":0,"issue_type":"epic","created_at":"2026-01-07T16:38:25.747251448-05:00","created_by":"ubuntu","updated_at":"2026-01-07T16:38:25.747251448-05:00"}
{"id":"meow-ks2","title":"Track agents from start beads","description":"Identify agents from start beads for wisp detection. See IMPLEMENTATION-PLAN section meow-modules-baker-agents.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T16:39:05.698904749-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:16:29.623052672-05:00","closed_at":"2026-01-07T18:16:29.623052672-05:00","close_reason":"YAGNI - With simplified tier detection, we don't scan for start beads. Tier is determined by workflow.Ephemeral property. Task types in ephemeral workflows are wisps, non-task types are orchestrator. Simple.","dependencies":[{"issue_id":"meow-ks2","depends_on_id":"meow-a85","type":"blocks","created_at":"2026-01-07T16:40:07.363200154-05:00","created_by":"ubuntu"},{"issue_id":"meow-ks2","depends_on_id":"meow-7x5","type":"blocks","created_at":"2026-01-07T16:40:07.474555034-05:00","created_by":"ubuntu"}]}
{"id":"meow-lxc","title":"Handle attach_wisp in handleStart","description":"Bake wisp template when start bead has attach_wisp. See IMPLEMENTATION-PLAN section meow-modules-orch-start.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T16:39:24.479863641-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:13:19.127971464-05:00","closed_at":"2026-01-07T18:13:19.127971464-05:00","close_reason":"YAGNI - attach_wisp is over-engineered. Auto-detection via ephemeral=true workflow property plus hooks_to for HookBead linking handles all real use cases. No concrete example where explicit attachment is needed. Can resurrect if a real use case emerges.","dependencies":[{"issue_id":"meow-lxc","depends_on_id":"meow-d1h","type":"blocks","created_at":"2026-01-07T16:39:47.52454027-05:00","created_by":"ubuntu"}]}
{"id":"meow-m3k","title":"Implement local reference resolution","description":"Resolve .workflow local references within module. See IMPLEMENTATION-PLAN section meow-modules-loader-local.","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T16:39:05.416312985-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:17:49.541826373-05:00","dependencies":[{"issue_id":"meow-m3k","depends_on_id":"meow-40s","type":"blocks","created_at":"2026-01-07T16:39:46.880060673-05:00","created_by":"ubuntu"}]}
{"id":"meow-mwc","title":"Implement meow steps command","description":"List all wisp steps for current agent. See IMPLEMENTATION-PLAN section meow-modules-cli-steps.","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T16:39:24.968274416-05:00","created_by":"ubuntu","updated_at":"2026-01-07T16:39:24.968274416-05:00","dependencies":[{"issue_id":"meow-mwc","depends_on_id":"meow-97m","type":"blocks","created_at":"2026-01-07T16:39:47.80486772-05:00","created_by":"ubuntu"}]}
{"id":"meow-nr7","title":"Create call pattern template","description":"Parent/child orchestration with attach_wisp. See IMPLEMENTATION-PLAN.","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T16:39:25.576149517-05:00","created_by":"ubuntu","updated_at":"2026-01-07T16:39:25.576149517-05:00","dependencies":[{"issue_id":"meow-nr7","depends_on_id":"meow-5u6","type":"blocks","created_at":"2026-01-07T16:39:48.177947179-05:00","created_by":"ubuntu"}]}
{"id":"meow-nsv","title":"Module System and Three-Tier Architecture","description":"Root epic for the module system and three-tier bead architecture. See docs/IMPLEMENTATION-PLAN-MODULES-AND-WISPS.md for full details.","status":"open","priority":0,"issue_type":"epic","created_at":"2026-01-07T16:38:16.142778125-05:00","created_by":"ubuntu","updated_at":"2026-01-07T16:38:16.142778125-05:00"}
{"id":"meow-p84","title":"Set HookBead links from variables","description":"Set HookBead links using workflow.HooksTo property per SPEC-ADDENDUM.\n\n## The hooks_to Property\n\nWorkflows declare which variable contains the work bead ID:\n\n```toml\n[implement]\nhooks_to = \"work_bead\"  # All wisps from this workflow link to {{work_bead}}\n\n[implement.variables]\nwork_bead = { required = true, type = \"bead_id\" }\n```\n\n## Baker Implementation\n\n```go\nfunc (b *Baker) setHookBead(bead *types.Bead, workflow *Workflow, vars map[string]string) {\n    // Only wisps get HookBead links\n    if bead.Tier != TierWisp {\n        return\n    }\n    \n    // Use workflow.HooksTo to find the variable name\n    if workflow.HooksTo == \"\" {\n        return  // No explicit linking\n    }\n    \n    // Get the bead ID from the variable\n    if hookID, ok := vars[workflow.HooksTo]; ok {\n        bead.HookBead = hookID\n    }\n}\n```\n\n## Key Change from Original Plan\n\n- **Before**: Magic detection via \"work_bead\" variable name\n- **After**: Explicit declaration via `workflow.HooksTo` property\n\n## File Location\nModify: `internal/template/baker.go`\n\n## Acceptance Criteria\n- [ ] Read HooksTo from workflow struct\n- [ ] Set HookBead only for wisp tier beads\n- [ ] Validate that HooksTo variable exists\n- [ ] Unit tests for HookBead linking","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T16:39:06.077463505-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:17:11.683209007-05:00","closed_at":"2026-01-07T18:17:11.683209007-05:00","close_reason":"Covered by meow-cac (vertical slice) which includes HookBead setting from hooks_to. Validation of HooksTo variable existence is part of module parsing in meow-ao5.","dependencies":[{"issue_id":"meow-p84","depends_on_id":"meow-cxt","type":"blocks","created_at":"2026-01-07T16:39:47.43086697-05:00","created_by":"ubuntu"},{"issue_id":"meow-p84","depends_on_id":"meow-8x2","type":"blocks","created_at":"2026-01-07T17:53:27.991474029-05:00","created_by":"ubuntu"}]}
{"id":"meow-sqc","title":"Types: Three-Tier Bead Metadata","description":"Extend bead types for three-tier visibility model. Phase 1 foundation.","notes":"Updated for SPEC-ADDENDUM refinements (2026-01-07):\n- Closed meow-db2 (hooked status removed from spec)\n- Added meow-x9z (gate bead type)  \n- Added meow-1l1 (collaborative bead type for interactive steps)\n- meow-bba now includes explicit Tier field and all 8 bead types\n- Labels are optional, Tier field is primary\n\nThe 8 bead types are now:\n- Agent-executable: task, collaborative, gate\n- Orchestrator-executable: start, stop, condition, code, expand","status":"open","priority":0,"issue_type":"epic","created_at":"2026-01-07T16:38:25.65411519-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:00:44.047875427-05:00"}
{"id":"meow-vvt","title":"Parser: Multi-Workflow Module Support","description":"Extend template parser for multi-workflow module files. Phase 1 foundation.","status":"open","priority":0,"issue_type":"epic","created_at":"2026-01-07T16:38:25.560890598-05:00","created_by":"ubuntu","updated_at":"2026-01-07T16:38:25.560890598-05:00"}
{"id":"meow-we4","title":"CLI: Wisp-Aware Commands","description":"Implement CLI commands that understand three-tier model. Phase 4.","status":"open","priority":0,"issue_type":"epic","created_at":"2026-01-07T16:38:26.03538728-05:00","created_by":"ubuntu","updated_at":"2026-01-07T16:38:26.03538728-05:00"}
{"id":"meow-x9z","title":"Add BeadTypeGate for human approval points","description":"Add new `gate` bead type per SPEC-ADDENDUM-WISPS-AND-MODULES.md (lines 214-231).\n\n## The Gate Type\n\n`gate` replaces the `orchestrator_task` boolean flag for human approval points:\n\n```go\nconst (\n    // Agent-executable\n    BeadTypeTask          BeadType = \"task\"          // Agent does work, auto-continues\n    BeadTypeCollaborative BeadType = \"collaborative\" // Agent + human conversation, pauses\n    BeadTypeGate          BeadType = \"gate\"          // Human approval point (no assignee)\n    \n    // Orchestrator-executable\n    BeadTypeStart     BeadType = \"start\"\n    BeadTypeStop      BeadType = \"stop\"\n    BeadTypeCondition BeadType = \"condition\"\n    BeadTypeCode      BeadType = \"code\"\n    BeadTypeExpand    BeadType = \"expand\"\n)\n```\n\n## Type Behavior Summary\n\n| Type | Assignee | Auto-continue | Who closes | Use case |\n|------|----------|---------------|------------|----------|\n| `task` | Required | Yes (Ralph Wiggum) | Agent | Normal autonomous work |\n| `collaborative` | Required | No (pauses) | Agent | Design review, clarification |\n| `gate` | None | No | Human | Approval checkpoints |\n\n## Gate Characteristics\n\n- **No assignee** - Human-facing, not agent-facing\n- **Tier: orchestrator** - Infrastructure machinery\n- **Orchestrator waits** - Like condition but requires human action\n- **No agent visibility** - Never shown in `meow prime`\n\n## Usage in Templates\n\n```toml\n[[workflow.steps]]\nid = \"human-review\"\ntype = \"gate\"\ntitle = \"Review implementation before merge\"\ninstructions = \"Check code quality, test coverage, and documentation\"\n# No assignee field - gates are human-facing\n```\n\n## File Location\nModify: `internal/types/bead.go`\n\n## Acceptance Criteria\n- [ ] BeadTypeGate constant added\n- [ ] Valid() updated to include gate\n- [ ] Gate validation: must NOT have assignee\n- [ ] Unit tests for gate type\n- [ ] Documentation updated","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-07T17:52:42.000899283-05:00","created_by":"ubuntu","updated_at":"2026-01-07T18:14:53.101991604-05:00","closed_at":"2026-01-07T18:14:53.101991604-05:00","close_reason":"Consolidated into meow-bba. The gate type is now part of the unified Bead struct changes task.","dependencies":[{"issue_id":"meow-x9z","depends_on_id":"meow-bba","type":"blocks","created_at":"2026-01-07T17:53:22.585095288-05:00","created_by":"ubuntu"}]}
{"id":"meow-xju","title":"Implement meow continue for crash recovery","description":"Resume interrupted workflow from persisted state. See IMPLEMENTATION-PLAN section meow-modules-cli-continue.","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-07T16:39:25.229851616-05:00","created_by":"ubuntu","updated_at":"2026-01-07T16:39:25.229851616-05:00","dependencies":[{"issue_id":"meow-xju","depends_on_id":"meow-97m","type":"blocks","created_at":"2026-01-07T16:39:47.989804784-05:00","created_by":"ubuntu"}]}
{"id":"meow-ym3","title":"Implement wisp lifecycle management (burn/squash)","description":"Implement wisp cleanup per SPEC-ADDENDUM (lines 859-904).\n\n## When Wisps Get Burned\n\n- **On workflow completion** (all beads in workflow are closed)\n- **NOT on agent stop** (agent might resume)\n- **NOT on work bead close** (workflow machinery still needed)\n\n## Implementation\n\n```go\nfunc (o *Orchestrator) cleanupWorkflow(ctx context.Context, workflowID string) error {\n    beads, _ := o.store.List(ctx, BeadFilter{\n        WorkflowID: workflowID,\n    })\n    \n    // Check if all beads are closed\n    allClosed := true\n    for _, bead := range beads {\n        if bead.Status != StatusClosed {\n            allClosed = false\n            break\n        }\n    }\n    \n    if allClosed {\n        // Delete non-work beads (wisps and orchestrator)\n        for _, bead := range beads {\n            if bead.Tier != TierWork {\n                _ = o.store.Delete(ctx, bead.ID)\n            }\n        }\n    }\n    \n    return nil\n}\n```\n\n## Cleanup Options\n\n```toml\n# .meow/config.toml\n[cleanup]\nephemeral = \"on_complete\"  # on_complete | manual | never\n```\n\n## Squash to Digest (Optional)\n\nBefore burning, optionally create a summary:\n```go\nfunc (o *Orchestrator) squashWisps(ctx context.Context, workflowID string, workBeadID string) error {\n    wisps, _ := o.store.List(ctx, BeadFilter{\n        WorkflowID: workflowID,\n        Tier:       TierWisp,\n    })\n    \n    // Generate digest\n    digest := generateDigest(wisps)\n    \n    // Append to work bead notes\n    workBead, _ := o.store.Get(ctx, workBeadID)\n    workBead.Notes += \"\\n\\n\" + digest\n    o.store.Update(ctx, workBead)\n    \n    // Then burn\n    return o.burnWisps(ctx, workflowID)\n}\n```\n\n## File Location\nModify: `internal/orchestrator/orchestrator.go`\n\n## Acceptance Criteria\n- [ ] cleanupWorkflow() deletes wisps and orchestrator beads\n- [ ] Only cleanup when all workflow beads closed\n- [ ] Work beads preserved\n- [ ] Optional squash to digest before burn\n- [ ] Cleanup triggered after workflow completion","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-07T16:39:24.725195883-05:00","created_by":"ubuntu","updated_at":"2026-01-07T17:55:41.036049652-05:00","dependencies":[{"issue_id":"meow-ym3","depends_on_id":"meow-cac","type":"blocks","created_at":"2026-01-07T18:15:49.00538433-05:00","created_by":"ubuntu"},{"issue_id":"meow-ym3","depends_on_id":"meow-dax","type":"blocks","created_at":"2026-01-07T18:19:40.710726869-05:00","created_by":"ubuntu"}]}
